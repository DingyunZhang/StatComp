<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dingyun Zhang" />

<meta name="date" content="2022-12-01" />

<title>Introduction2 to StatComp22004</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction2 to StatComp22004</h1>
<h4 class="author">Dingyun Zhang</h4>
<h4 class="date">2022-12-01</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载包</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(snowfall)</span></code></pre></div>
<pre><code>## Loading required package: snow</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)   </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)     </span></code></pre></div>
<pre><code>## corrplot 0.92 loaded</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)     </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<div id="hw0" class="section level2">
<h2>HW0</h2>
<p><strong>Problem</strong></p>
<p>Use knitr package to produce examples of texts, figures and tables
respectively.</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">11</span>),<span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">7</span>),<span class="fu">rep</span>(<span class="dv">3</span>, <span class="dv">9</span>),<span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">4</span>),<span class="fu">rep</span>(<span class="dv">5</span>, <span class="dv">6</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>, <span class="fl">5.5</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">terrain.colors</span>(<span class="dv">5</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> b, <span class="at">labels =</span> a, <span class="at">col =</span> d)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hw1" class="section level2">
<h2>HW1</h2>
<div id="exercise-3.3" class="section level3">
<h3>Exercise 3.3</h3>
<p><strong>Problem.</strong> The Pareto<span class="math inline">\((a,b)\)</span> distribution has cdf <span class="math display">\[F(x)=1-\left(\frac{b}{x}\right)^a,\quad x\geq
b&gt;0,a&gt;0.\]</span> Derive the probability inverse transformation
<span class="math inline">\(F^{-1}(U)\)</span> and use the inverse
transform method to simulate a random sample from the Pareto<span class="math inline">\((2,2)\)</span> distribution. Graph the density
histogram of the sample with the Pareto<span class="math inline">\((2,2)\)</span> density superimposed for
comparison.</p>
<p><strong>Solution.</strong> Due to the fact that if <span class="math inline">\(X\)</span> is a continuous random variable with
cdf <span class="math inline">\(F_X(x)\)</span>, then <span class="math inline">\(U=F_X(X)\sim U(0,1)\)</span>, we conduct the
<strong>inverse transform algorithm</strong> to generate random number
with Pareto distribution.</p>
<p>It can be solved that the inverse of <span class="math inline">\(F(x)\)</span> is <span class="math display">\[F^{-1}(x)=b(1-x)^{-1/a},\quad
0&lt;x&lt;1.\]</span> Besides, the derirative of <span class="math inline">\(F(x)\)</span> (i.e. the pdf of <span class="math inline">\(X\)</span>) is <span class="math display">\[f(x)=F&#39;(x)=\dfrac{a\cdot b^a}{x^{a+1}},\quad
x\geq b&gt;0,a&gt;0.\]</span> The algorithm is shown below.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22004</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pareto <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b) {</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random numbers with cdf F(x)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">10000</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> b<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>a)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the histogram of random numbers generated</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Pareto(&#39;</span>,a,<span class="st">&#39;,&#39;</span>,b,<span class="st">&#39;)&#39;</span>))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the density function f(x)</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(x), <span class="fl">0.1</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y, a<span class="sc">*</span>b<span class="sc">^</span>a<span class="sc">/</span>(y<span class="sc">^</span>(a<span class="sc">+</span><span class="dv">1</span>)))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">pareto</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be shown that the histogram of random numbers well fit the
therotical density of Pareto distribution.</p>
</div>
<div id="exercise-3.7" class="section level3">
<h3>Exercise 3.7</h3>
<p><strong>Problem.</strong> Write a function to generate a random
sample of size <span class="math inline">\(n\)</span> from the Beta<span class="math inline">\((a,b)\)</span> distribution by the
acceptance-rejection method. Generate a random sample of size 1000 from
the Beta<span class="math inline">\((3,2)\)</span> distribution. Graph
the histogram of the sample with the theoretical Beta<span class="math inline">\((3,2)\)</span> density superimposed.</p>
<p><strong>Solution.</strong> Suppose <span class="math inline">\(X\sim\)</span>Beta<span class="math inline">\((a,b)\)</span>, the density of <span class="math inline">\(X\)</span> is <span class="math display">\[f(x)=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1},\quad
0&lt;x&lt;1.\]</span> It can be obtained that <span class="math display">\[x_0=\underset{x\in(0,1)}{\arg\max}~f(x)=\frac{a-1}{a+b-2}.\]</span>
Let reference density be <span class="math inline">\(g(x)=\pmb
1_{\{0&lt;x&lt;1\}}\)</span>, then <span class="math display">\[\frac{f(x)}{g(x)}=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}\leq
c=f(x_0).\]</span></p>
<p>Based on the <strong>acceptance-rejection algorithm</strong>, our
algorithm is shown below:</p>
<ul>
<li>Generate random numbers <span class="math inline">\(U\sim
U(0,1)\)</span> and <span class="math inline">\(Y\sim g(\cdot)\)</span>,
i.e. <span class="math inline">\(Y\sim U(0,1)\)</span>;</li>
<li>if <span class="math inline">\(U\leq\dfrac{f(Y)}{cg(Y)}\)</span>,
then accept <span class="math inline">\(Y\)</span> and return <span class="math inline">\(X=Y\)</span>; otherwise reject <span class="math inline">\(Y\)</span> and continue.</li>
</ul>
<p><strong>Remark.</strong> <span class="math inline">\(f(\cdot)\)</span> and <span class="math inline">\(c\)</span> have a common constant <span class="math inline">\(\dfrac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\)</span>,
so in the algorithm, we just cancel and ignore the constant.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22004</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b) {</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate constant c</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  x0 <span class="ot">&lt;-</span> (a<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> x0<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x0)<span class="sc">^</span>(b<span class="dv">-1</span>)  <span class="co"># constant in pdf can be ignored</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random numbers with pdf f(x)</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># random variate from g(x)</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">/</span> c <span class="sc">&gt;</span> u) {</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      <span class="co"># accept x</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the histogram of random numbers generated</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Beta(&#39;</span>,a,<span class="st">&#39;,&#39;</span>,b,<span class="st">&#39;)&#39;</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Draw the density function f(x)</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(z, z<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>z)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">gamma</span>(a<span class="sc">+</span>b)<span class="sc">/</span><span class="fu">gamma</span>(a)<span class="sc">/</span><span class="fu">gamma</span>(b))</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="fu">beta</span>(<span class="dv">3</span>, <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be shown that the histogram of random numbers well fit the
therotical density of Beta distribution.</p>
</div>
<div id="question3ans" class="section level3">
<h3>Exercise 3.12</h3>
<p><strong>Problem.</strong> Simulate a continuous Exponential-Gamma
mixture. Suppose that the rate parameter <span class="math inline">\(\Lambda\)</span> has Gamma<span class="math inline">\((r,\beta)\)</span> distribution and <span class="math inline">\(Y\)</span> has Exp<span class="math inline">\((\Lambda)\)</span> distribution. That is, <span class="math inline">\((Y|\Lambda=\lambda)\sim f_Y(y|\lambda)=\lambda{\rm
e}^{-\lambda y}\pmb 1_{\{y\geq 0\}}\)</span>. Generate 1000 random
observations from this mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>.</p>
<p><strong>Solution.</strong> According to the mixture model, we first
generate <span class="math inline">\(\Lambda\)</span> from Gamma<span class="math inline">\((r,\beta)\)</span> distribution, then generate
<span class="math inline">\(Y\)</span> from Exp<span class="math inline">\((\Lambda)\)</span> distribution. The code is shown
below.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22004</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>expgamma <span class="ot">&lt;-</span> <span class="cf">function</span>(r, beta) {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate random numbers from the mixture</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, r, beta)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, x)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">4</span>; beta <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>rnd <span class="ot">=</span> <span class="fu">expgamma</span>(r, beta)</span></code></pre></div>
<p>1000 random observations from the mixture are stored in the variable
<code>rnd</code>.</p>
</div>
<div id="exercise-3.13" class="section level3">
<h3>Exercise 3.13</h3>
<p><strong>Problem.</strong> It can be shown that the mixture in
Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-\left(\frac{\beta}{\beta+y}\right)^r,\quad
y\geq0.\]</span> (This is an alternative parameterization of the Pareto
cdf given in Exercise 3.3.) Generate 1000 random observations from the
mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2\)</span>. Compare the empirical and
theoretical (Pareto) distributions by graphing the density histogram of
the sample and superimposing the Pareto density curve.</p>
<p><strong>Solution.</strong></p>
<p>Given the cdf <span class="math inline">\(F(y)\)</span>, the density
function of <span class="math inline">\(Y\sim F(y)\)</span> is <span class="math display">\[f(y)=\frac{r\cdot\beta^r}{(\beta+y)^{r+1}},\quad
y\geq0.\]</span> So we can draw the histogram of random numbers we got
before and the density function above.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the histogram of random numbers generated</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(rnd, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Pareto(&#39;</span>,r,<span class="st">&#39;,&#39;</span>,beta,<span class="st">&#39;)&#39;</span>), <span class="at">xlab =</span> <span class="st">&quot;y&quot;</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the density function f(y)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(rnd), <span class="fl">0.01</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, r<span class="sc">*</span>beta<span class="sc">^</span>r<span class="sc">/</span>(beta<span class="sc">+</span>y)<span class="sc">^</span>(r<span class="sc">+</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It can be shown that the histogram of random numbers well fit the
therotical density of Pareto distribution.</p>
</div>
</div>
<div id="hw2" class="section level2">
<h2>HW2</h2>
<div id="fast-sort-algorithm" class="section level3">
<h3>Fast sort algorithm</h3>
<p><strong>Problem.</strong></p>
<ul>
<li><p>For <span class="math inline">\(n=10^4, 2\times 10^4, 4\times
10^4, 6\times 10^4, 8\times 10^4\)</span>, apply the fast sorting
algorithm to randomly permuted numbers of <span class="math inline">\(1,\dots,n\)</span>.</p></li>
<li><p>Calculate computation time averaged over 100 simulations, denoted
by <span class="math inline">\(a_n\)</span>.</p></li>
<li><p>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log(n)\)</span>, and graphically show the
results (scatter plot and regression line).</p></li>
</ul>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This part is copied from bb</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>quick_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    lower <span class="ot">&lt;-</span> y[y<span class="sc">&lt;</span>a]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    upper <span class="ot">&lt;-</span> y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))}<span class="co">#form a loop</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>test<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">1e4</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## user.self 
##      0.04</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">quick_sort</span>(test)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># show the result of fast sort algorithm</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>test[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>test[<span class="dv">9991</span><span class="sc">:</span><span class="dv">10000</span>]</span></code></pre></div>
<pre><code>##  [1]  9991  9992  9993  9994  9995  9996  9997  9998  9999 10000</code></pre>
<p>As is shown above, the fast sort algorithm is applied on the sequence
<code>test</code> successfully.</p>
<p>Then we write a function to calculate the computation time denoted by
<span class="math inline">\(a_n\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>, <span class="fl">2e4</span>, <span class="fl">4e4</span>, <span class="fl">6e4</span>, <span class="fl">8e4</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>computation_time <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    test <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    t[i] <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(test))[<span class="dv">1</span>]</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  t_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(t)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(t_mean)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">computation_time</span>(n[<span class="dv">1</span>]),<span class="fu">computation_time</span>(n[<span class="dv">2</span>]),<span class="fu">computation_time</span>(n[<span class="dv">3</span>]),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">computation_time</span>(n[<span class="dv">4</span>]),<span class="fu">computation_time</span>(n[<span class="dv">5</span>]))</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>an</span></code></pre></div>
<pre><code>## [1] 0.0135 0.0274 0.0602 0.0863 0.1177</code></pre>
<p>Now we fit a linear model with control variable <span class="math inline">\(t_n\)</span> and response <span class="math inline">\(a_n\)</span>, and draw a scatter plot and the red
regression line.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">log</span>(n)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(an<span class="sc">~</span>tn)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">1e6</span>,<span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coefficients</span>(mylm)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tn, an, <span class="at">main=</span><span class="st">&quot;Regression line&quot;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, b[<span class="dv">1</span>]<span class="sc">+</span>b[<span class="dv">2</span>]<span class="sc">*</span>x, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-5.6" class="section level3">
<h3>Exercise 5.6</h3>
<p><strong>Problem.</strong>In Example 5.7 the control variate approach
was illustrated for Monte Carlo integration of <span class="math display">\[
\theta=\int_0^1 e^x dx.
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\sim {\rm Uniform}(0,1)\)</span>. What is the
percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
<p><strong>Solution.</strong> Since <span class="math inline">\(U\sim{\rm Uniform}(0,1)\)</span>, we have <span class="math inline">\(E(e^U)=e-1=E(e^{U-1})\)</span>, and <span class="math inline">\(E(e^{2U})=(e^2-1)/2\)</span>. Hence, we have <span class="math display">\[
\begin{aligned}
Cov\left(e^U,e^{1-U}\right)&amp;=E\left(e^Ue^{1-U}\right)-E\left(e^U\right)E\left(e^{1-U}\right)
\\
&amp;=e-(e-1)^2 \\
&amp;= -0.2342106,
\end{aligned}
\]</span> and <span class="math display">\[
\begin{aligned}
Var\left(e^U+e^{1-U}\right)&amp;=E\left(e^U+e^{1-U}\right)^2-\left[E\left(e^U+e^{1-U}\right)\right]^2
\\
&amp;=E\left(e^{2U}+e^{2-2U}+2e\right)-4(e-1)^2 \\
&amp;=e^2-1+2e-4(e-1)^2 \\
&amp;=-3e^2+10e-5 \\
&amp;=0.01564999.
\end{aligned}
\]</span></p>
<p>The simple MC estimator of <span class="math inline">\(\theta\)</span> is <span class="math inline">\(\hat\theta_1=\frac{1}{m}\sum_{i=1}^m
e^{u_i}\)</span>, where <span class="math inline">\(u_i,i=1,\dots,m\)</span> is an i.i.d sample of
<span class="math inline">\({\rm Uniform(0,1)}\)</span>. The antithetic
variates estimator is <span class="math inline">\(\hat\theta_2=\frac{1}{m}\sum_{i=1}^m
\left(\frac{e^{u_i}+e^{1-u_i}}{2}\right)\)</span>. By the i.i.d
condition, we derive that <span class="math inline">\(Var(\hat\theta_1)=Var(e^U)/m\)</span>, where <span class="math display">\[
\begin{aligned}
Var(e^U)&amp;=E\left(e^{2U}\right)-\left[E(e^U)\right]^2 \\
&amp;=(e^2-1)/2-(e-1)^2 \\
&amp;=0.2420356,
\end{aligned}
\]</span> and <span class="math inline">\(Var(\hat\theta_2)=Var(e^U+e^{1-U})/4m\)</span>.
Now we can compute the percent reduction <span class="math display">\[
\begin{aligned}
100\left(\frac{Var(\hat\theta_1)-Var(\hat\theta_2)}{Var(\hat\theta_1)}\right)&amp;=100\left(\frac{0.2420356-0.01564999/4}{0.2420356}\right)
\\
&amp;=98.38.
\end{aligned}
\]</span></p>
</div>
<div id="exercise-5.7" class="section level3">
<h3>Exercise 5.7</h3>
<p><strong>Problem.</strong>Refer to Exercise 5.6. Use a Monte Carlo
simulation to estimate <span class="math inline">\(\theta\)</span> by
the antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
<p><strong>Solution.</strong> In this simulation, we generate an i.i.d
sample of <span class="math inline">\({\rm Uniform}(0,1)\)</span> with
size <span class="math inline">\(10^4\)</span>. Then we compute the
simple MC estimator <span class="math inline">\(\hat\theta_1\)</span>
and antithetic variables approach estimator <span class="math inline">\(\hat\theta_2\)</span>. Next, we compute the sample
variance and plug in to obtain the empirical estimator of percent
reduction in variance.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">exp</span>(U))                <span class="co"># simple MC estimator</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="fu">mean</span>((<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span>)   <span class="co"># antithetic variables estimator</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="fu">exp</span>(U))                   <span class="co"># sample variance of simple MC</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">var</span>((<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span>)      <span class="co"># sample variance of antithetic variables</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>theta1</span></code></pre></div>
<pre><code>## [1] 1.719891</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>theta2</span></code></pre></div>
<pre><code>## [1] 1.71941</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="sc">*</span>(var1<span class="sc">-</span>var2)<span class="sc">/</span>var1      <span class="co"># empirical estimator of percent reduction of variance</span></span></code></pre></div>
<pre><code>## [1] 98.38075</code></pre>
<p>As is shown above, we obtain <span class="math inline">\(\hat\theta_1=1.719891\)</span> and <span class="math inline">\(\hat\theta_2=1.71941\)</span>, both are closed to
the theoretical value <span class="math inline">\(e-1=1.71828\)</span>.
The empirical estimate of percent reduction is <span class="math inline">\(98.38075\)</span>, which is also closed to the
theoretical value <span class="math inline">\(98.3835\)</span> obtained
in exercise 5.6.</p>
</div>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
<div id="exercise-5.13" class="section level3">
<h3>Exercise 5.13</h3>
<p><strong>Problem.</strong> Find two impotance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to</p>
<p><span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad
x&gt;1.\]</span></p>
<p>Which of your two importance functions should produce the smaller
variance in estimating</p>
<p><span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span></p>
<p>by importance sampling? Explain.</p>
<p><strong>Solution.</strong></p>
<p>The candidates for the importance function are</p>
<p><span class="math display">\[
\begin{aligned}
f_1(x)&amp;=\frac{1}{\sqrt{2\pi}}e^{-x^2/2},\quad
-\infty&lt;x&lt;\infty,\\
f_2(x)&amp;=\frac{1}{2}x^2e^{-x},\quad 0&lt;x&lt;\infty,
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(f_1\)</span> is density function
for <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(f_2\)</span> is density for <span class="math inline">\(\Gamma(3,1)\)</span>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span><span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
<p>We use importance sampling to calculate the integration.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span>m)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># using f1</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>fg[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span><span class="fu">mean</span>(fg[<span class="dv">1</span>,])</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg[<span class="dv">1</span>,])</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># using f2</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>fg[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span><span class="fu">mean</span>(fg[<span class="dv">2</span>,])</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg[<span class="dv">2</span>,])</span></code></pre></div>
<p>The estimates (labeled theta.hat) of <span class="math inline">\(\int_1^{\infty} g(x)dx\)</span> and the
corresponding standard errors se for the simulation using each of the
importance functions are:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.4021799 0.3956735
## se        1.1255863 0.4559163</code></pre>
<p>The simulation indicates that <span class="math inline">\(f_2\)</span> produce smaller variance than <span class="math inline">\(f_1\)</span>. Because <span class="math inline">\(f_1\)</span> is supported on the entire real line,
while <span class="math inline">\(g\)</span> is supported only on <span class="math inline">\((1,\infty)\)</span>. There are a vary large number
of zeros (more than 75%) produced in the ratio <span class="math inline">\(g(x)/f(x)\)</span>, and all other values far from
0, resulting in a large variance. But the ratio for <span class="math inline">\(f_2\)</span> is less than 25%. So <span class="math inline">\(f_2\)</span> performs better than <span class="math inline">\(f_1\)</span>. The following summary statistics for
the ratio <span class="math inline">\(g(x)/f_1(x)\)</span> and <span class="math inline">\(g(x)/f_2(x)\)</span> confirm this.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fg[<span class="dv">1</span>,])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.0000  0.4022  0.0000 14.5766</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fg[<span class="dv">2</span>,])</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.000000 0.002145 0.159973 0.395674 0.767270 1.315489</code></pre>
</div>
<div id="exercise-5.15" class="section level3">
<h3>Exercise 5.15</h3>
<p><strong>Problem.</strong> Obtain the stratified importance sampling
estimate in Example 5.13 and compare it with the result of Example
5.10.</p>
<p><strong>Solution.</strong></p>
<p>We need to estimate <span class="math inline">\(\theta =
\int_0^1\frac{e^{-x}}{1+x^2}dx\)</span>.</p>
<p>The best results in Example 5.13 is obtained by the importance
function <span class="math display">\[f_3(x)=e^{-x}/(1-e^{-1}),\quad
0&lt;x&lt;1,\]</span> corresponding codes are in below:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># f3, inverse transform method</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>theta.im <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>se.im <span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span></code></pre></div>
<p>In this way <span class="math inline">\(\hat{\theta}_1=\)</span>
0.5234 with <span class="math inline">\(se(\hat{\theta}_1)=\)</span>
0.0972.</p>
<p>Then we cut the interval as 5-folds: <span class="math inline">\(\left(F^{-1}((j-1)/5),F^{-1}(j/5)\right),j=1,\dots,5\)</span>.
On the <span class="math inline">\(j^{th}\)</span> subinterval variables
are generated from the density</p>
<p><span class="math display">\[\frac{5e^{-x}}{1-e^{-1}}\times1\left(F^{-1}((j-1)/5)&lt;x&lt;
F^{-1}(j/5)\right),\]</span></p>
<p>where <span class="math inline">\(F^{-1}(t)=-\log\left(1-(1-e^{-1})t\right)\)</span>.</p>
<p>Consider <span class="math inline">\(U_j\sim U[\frac
{j-1}{5},\frac{j}{5}],j=1,\dots,5\)</span> and <span class="math inline">\(\int_0^X\frac{e^{-t}}{1-e^{-1}}dt=U_j\)</span>.
Then we know X have the density <span class="math inline">\(\frac{5e^{-x}}{1-e^{-1}}\times1\left(F^{-1}((j-1)/5)&lt;x&lt;
F^{-1}(j/5)\right).\)</span></p>
<p>Now let we use transformation method to implement stratified
importance sampling.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>m<span class="sc">/</span>k</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>theta_s <span class="ot">&lt;-</span> var_s <span class="ot">&lt;-</span><span class="fu">numeric</span>(k)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>,i<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>k<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  theta_s[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  var_s[i]<span class="ot">&lt;-</span><span class="fu">var</span>(fg)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <span class="math inline">\(\hat{\theta}\)</span> is</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(theta_s)</span></code></pre></div>
<pre><code>## [1] 0.5246954</code></pre>
<p>And <span class="math inline">\(se(\hat{\theta})\)</span> is</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>(var_s))</span></code></pre></div>
<pre><code>## [1] 0.00938088</code></pre>
<p>which is less than one-tenth of simple importance sampling method
(<span class="math inline">\(se(\hat{\theta}_1)=\)</span> 0.0972).</p>
</div>
</div>
<div id="hw4" class="section level2">
<h2>HW4</h2>
<div id="question1ans" class="section level3">
<h3>Exercise 6.4</h3>
<p><strong>Problem.</strong> Suppose that <span class="math inline">\(X_1,\dots, X_n\)</span> are a random sample from a
from a log normal distribution with unknown parameters. Construct a
<span class="math inline">\(95\%\)</span> confidence interval for the
parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo
method to obtain an empirical estimate of the confidence level.</p>
<p><strong>Solution.</strong></p>
<p>The log normal distribution has density <span class="math display">\[
f(x)=\frac{1}{\sqrt{2\pi}\sigma x}e^{-(\log(x)-\mu)^2/2\sigma^2},
\]</span> where <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the mean and standard
deviation of the logarithm. Moreover, if <span class="math inline">\(X\sim LN(\mu,\sigma^2)\)</span>, then <span class="math inline">\(\ln X\sim N(\mu,\sigma^2)\)</span>. Hence, the
confidence interval of level <span class="math inline">\(\alpha\)</span>
can be formulated by <span class="math display">\[
[\bar{Y}-t_{n-1}(\alpha/2)S_y/\sqrt{n},\bar{Y}+t_{n-1}(\alpha/2)S_y/\sqrt{n}]
\]</span></p>
<p>We first write functions to generate a sample and construct the
confidence interval based the sample and given confidence level.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample generation function</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>sample_gen <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="dv">1</span>){</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rlnorm</span>(<span class="at">n=</span>n, <span class="at">meanlog =</span> mu, <span class="at">sdlog =</span> sigma)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data analysis function (constuct a confidence interval with level alpha)</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">alpha=</span><span class="fl">0.05</span>){</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">log</span>(x)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  mu.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  sigma2.hat <span class="ot">&lt;-</span> <span class="fu">var</span>(y)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> mu.hat<span class="sc">+</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(sigma2.hat<span class="sc">/</span>n)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> mu.hat<span class="sc">+</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(sigma2.hat<span class="sc">/</span>n)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">&quot;lower.bound&quot;</span><span class="ot">=</span>lower,<span class="st">&quot;upper.bound&quot;</span><span class="ot">=</span>upper))</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we apply our function under the setting <span class="math inline">\(n=10,\mu=0,\sigma^2=1\)</span>, and repeat for
<span class="math inline">\(m=10000\)</span> times to estimate the
coverage probability (CP).</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> upper <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  Sample <span class="ot">&lt;-</span> <span class="fu">sample_gen</span>(<span class="at">n=</span><span class="dv">10</span>, <span class="at">mu=</span><span class="dv">0</span>, <span class="at">sigma=</span><span class="dv">1</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  lower[i] <span class="ot">&lt;-</span> <span class="fu">CI</span>(<span class="at">x=</span>Sample)[<span class="dv">1</span>]</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  upper[i] <span class="ot">&lt;-</span> <span class="fu">CI</span>(<span class="at">x=</span>Sample)[<span class="dv">2</span>]</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>CP <span class="ot">&lt;-</span> <span class="fu">mean</span>((lower<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">&amp;</span>(upper<span class="sc">&gt;</span><span class="dv">0</span>))</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;CP =&quot;</span>,CP)</span></code></pre></div>
<pre><code>## CP = 0.9505</code></pre>
<p>Finally, we clean the memory of the variables.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercise-6.8" class="section level3">
<h3>Exercise 6.8</h3>
<p><strong>Problem.</strong>Refer to Example 6.16. Repeat the
simulation, but also compute the F test of equal variance, at
significance level <span class="math inline">\(\hat\alpha \doteq
0.055\)</span>. Compare the power of the Count Five test and F test for
small, medium, and large sample sizes. (Recall that the F test is not
applicable for non-normal distributions.)</p>
<p><strong>Solution.</strong> At the beginning, we write the functions
of “Count Five” test and F test.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The functions of &quot;Count Five&quot; test is copied from the book</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>maxout <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>F.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">alpha=</span><span class="fl">0.05</span>){</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  S1 <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  S2 <span class="ot">&lt;-</span> <span class="fu">var</span>(y)</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> S2<span class="sc">/</span>S1</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(f<span class="sc">&gt;</span><span class="fu">qf</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df1 =</span> n<span class="dv">-1</span>,<span class="at">df2 =</span> m<span class="dv">-1</span>)<span class="sc">||</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>                           f<span class="sc">&lt;</span><span class="fu">qf</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df1 =</span> n<span class="dv">-1</span>,<span class="at">df2 =</span> m<span class="dv">-1</span>)))</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we write functions to compute the empirical power of “Count
Five” test and F test.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>power_count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n1, n2, sigma1, sigma2){</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count5test</span>(x, y)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>power_F.test <span class="ot">&lt;-</span> <span class="cf">function</span>(m, n1, n2, sigma1, sigma2){</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr =</span> {</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">F.test</span>(x, y, <span class="at">alpha =</span> <span class="fl">0.055</span>)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we compute the powers of the two tests under different sample
sizes, that is <span class="math inline">\(n_1=n_2=20,100,1000\)</span>,
and we summarize the results in the table below.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>result2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  result1[i] <span class="ot">&lt;-</span> <span class="fu">power_count5test</span>(m, <span class="at">n1=</span>n[i], <span class="at">n2=</span>n[i], sigma1, sigma2)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  result2[i] <span class="ot">&lt;-</span> <span class="fu">power_F.test</span>(m, <span class="at">n1=</span>n[i], <span class="at">n2=</span>n[i], sigma1, sigma2)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">data.frame</span>(<span class="st">&quot;size&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">100</span>,<span class="dv">200</span>),<span class="st">&quot;count five test&quot;</span><span class="ot">=</span>result1,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;F test&quot;</span><span class="ot">=</span>result2))</span></code></pre></div>
<table style="width:47%;">
<colgroup>
<col width="9%" />
<col width="25%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">size</th>
<th align="center">count.five.test</th>
<th align="center">F.test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">20</td>
<td align="center">0.3104</td>
<td align="center">0.4162</td>
</tr>
<tr class="even">
<td align="center">100</td>
<td align="center">0.8545</td>
<td align="center">0.9807</td>
</tr>
<tr class="odd">
<td align="center">200</td>
<td align="center">0.998</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>From the table we can see that the power of F test is higher than the
power of “Count Five” test when the sample is normal distributed.</p>
<p>Finally, we clean the memory of the variables.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p><strong>Problem.</strong>If we obtain the powers for two methods
under a particular simulation setting with 10,000 experiments: say,
0.651 for one method and 0.676 for another method. We want to know if
the powers are different at 0.05 level.</p>
<ul>
<li><p>1.What is the corresponding hypothesis test problem?</p></li>
<li><p>2.What test should we use? Z-test, two-sample t-test, paired-t
test or McNemar test? Why?</p></li>
<li><p>3.Please provide the least necessary information for hypothesis
testing.</p></li>
</ul>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(H_{0}\)</span>:The two methods have
the same power.<span class="math inline">\(\leftrightarrow\)</span>
<span class="math inline">\(H_{1}\)</span>:The two methods have
different powers.</p></li>
<li><p>McNemar test. Because it is equivalent to test whether the
acceptance rates of the two methods are the same. Also, a contingency
table can be naturally constructed as in 3.</p></li>
<li><p>For instance, consider the following contingency table.</p></li>
</ol>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">6510</span>, <span class="dv">3490</span>, <span class="dv">10000</span>, <span class="dv">6760</span>, <span class="dv">3240</span>, <span class="dv">10000</span>, <span class="dv">13270</span>, <span class="dv">6730</span>, <span class="dv">20000</span>), <span class="dv">3</span>, <span class="dv">3</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">&quot;Rejected&quot;</span>, <span class="st">&quot;Accepted&quot;</span>, <span class="st">&quot;total&quot;</span>),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(<span class="st">&quot;method A&quot;</span>, <span class="st">&quot;method B&quot;</span>, <span class="st">&quot;total&quot;</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>         ))</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>mat</span></code></pre></div>
<pre><code>##          method A method B total
## Rejected     6510     6760 13270
## Accepted     3490     3240  6730
## total       10000    10000 20000</code></pre>
<p>The test statistic: <span class="math display">\[\chi^2 =
\sum_{i,j=1}^{2}\frac{(n_{ij}-n_{i+}n_{+j}/n)^{2}}{n_{i+}n_{+j}/n}
\rightarrow \chi_{1}^2\]</span></p>
<p>Note that <span class="math inline">\(\chi^2=13.9966\)</span>and the
p-value is <span class="math inline">\(P(\chi_{1}^2&gt;\chi^2)=0.0001861415&lt;0.05\)</span>.Thus,we
reject the null hypothesis <span class="math inline">\(H_{0}\)</span>,i.e.the powers are different at
0.05 level.</p>
</div>
</div>
<div id="hw5" class="section level2">
<h2>HW5</h2>
<div id="exercises-7.4" class="section level3">
<h3>Exercises 7.4</h3>
<p><strong>Problem</strong> Refer to the air-conditioning data set
<strong>aircondit</strong> provided in the boot package. The 12
observations are the times in hours between failures of air-conditioning
equipment [63, Example 1.1]: <span class="math display">\[3, 5, 7, 18,
43, 85, 91, 98, 100, 130, 230, 487.\]</span> Assume that the times
between failures follow an exponential model Exp(<span class="math inline">\(\lambda\)</span>). Obtain the MLE of the hazard
rate <span class="math inline">\(\lambda\)</span> and use bootstrap to
estimate the bias and standard error of the estimate.</p>
<p><strong>Solution</strong> The <strong>aircondit</strong> data is a
data frame with 1 variable, so aircondit[1] extracts the 12
observations. As the times between failures follow an exponential model
Exp(λ), the Log-likelihood function is <span class="math display">\[ln[l(X|\lambda)]=-\lambda\sum_{i=1}^nx_i+nln(\lambda)\]</span>
therefore we have</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \frac{\partial ln[l(X|\lambda)]}{\partial
\lambda}=-\sum_{i=1}^nx_i+\frac{n}{\lambda} \\
&amp; \frac{\partial ln[l(X|\lambda)]}{\partial \lambda}=0 \\
&amp; \Rightarrow -\sum_{i=1}^nx_i+\frac{n}{\lambda}=0\\
&amp; \Rightarrow \hat{\lambda}=\frac{1}{\bar{x}}
\end{aligned}
\]</span></p>
<p>Hence the MLE of <span class="math inline">\(\lambda\)</span> is
<span class="math inline">\(1/\bar{x}\)</span>. We can use
<strong>boot</strong> package to print the estimates of bias and
standard error. As what we discussed in class, we can use separate
functions for data generation, data analysis and result reporting. In
this exercise, define function <strong>Sample1</strong> to extract data,
function <strong>Rate1</strong> to construct the statistic and function
<strong>Result1</strong> to report the result.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>Sample1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> aircondit[x]</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  samp</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>Rate1 <span class="ot">&lt;-</span> <span class="cf">function</span>(samp, i) {</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  rat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(<span class="fu">as.matrix</span>(samp[i, ]))</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  rat</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>Result1 <span class="ot">&lt;-</span> <span class="cf">function</span>(samp,func,Rr){</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  bo <span class="ot">&lt;-</span> <span class="fu">boot</span>(samp, <span class="at">statistic =</span> func, <span class="at">R =</span> Rr)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(bo)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>samp <span class="ot">&lt;-</span> <span class="fu">Sample1</span>(<span class="dv">1</span>)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>resu <span class="ot">&lt;-</span> <span class="fu">Result1</span>(samp,Rate1,<span class="dv">2000</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = samp, statistic = func, R = Rr)
## 
## 
## Bootstrap Statistics :
##       original      bias    std. error
## t1* 0.00925212 0.001368607 0.004985968</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the result above, we can see that the the bias of the estimate
is 0.001369 and standard error of the estimate is 0.004986.</p>
</div>
<div id="exercises-7.5" class="section level3">
<h3>Exercises 7.5</h3>
<p><strong>Problem</strong>Refer to Exercise 7.4. Compute 95% bootstrap
confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p><strong>Solution</strong> Similarly, use
<strong>aircondit[1]</strong> to extract the data. In this exercise,
define function <strong>Sample2</strong> to extract data, function
<strong>Meant2</strong> to construct the statistic and function
<strong>Result2</strong> to report the result.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>Sample2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> aircondit[x]</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  samp</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>Meant2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) {</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  mea <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.matrix</span>(x[i, ]))</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  mea</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>Result2 <span class="ot">&lt;-</span> <span class="cf">function</span>(samp,func,Rr){</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  bo <span class="ot">&lt;-</span> <span class="fu">boot</span>(samp, <span class="at">statistic =</span> func, <span class="at">R =</span> Rr)</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  re <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bo, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(bo)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(re)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(bo<span class="sc">$</span>t, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(bo<span class="sc">$</span>t0, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  bo</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>samp <span class="ot">&lt;-</span> <span class="fu">Sample2</span>(<span class="dv">1</span>)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>resu <span class="ot">&lt;-</span> <span class="fu">Result2</span>(samp,Meant2,<span class="dv">2000</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = samp, statistic = func, R = Rr)
## 
## 
## Bootstrap Statistics :
##     original    bias    std. error
## t1* 108.0833 0.1913333    38.21869
## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bo, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;basic&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.0, 182.8 )   ( 19.9, 170.0 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.2, 196.2 )   ( 58.5, 232.2 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>The 95% bootstrap confidence intervals for the mean time between
failures 1/λ by the standard normal method is (33.0, 182.8), by the
basic method is (19.9, 170.0), by the percentile method is (46.2, 196.2)
and by BCa method is (58.5, 232.2). They differ from each other and the
length of intervals are -149.8, -150.1, -150 and -173.5
respectively.</p>
<p>The replicates are not approximately normal, so the normal and
percentile intervals differ. From the histogram of replicates, it
appears that the distribution of the replicates is skewed, although we
are estimating a mean. The reason is that the sample size is too small
for CLT to give a good approximation here. The BCa interval is a
percentile type interval, but it adjusts for both skewness and bias, so
the BCa interval differs from the others.</p>
</div>
<div id="exercises-7.a" class="section level3">
<h3>Exercises 7.A</h3>
<p><strong>Problem</strong> Conduct a Monte Carlo study to estimate the
coverage probabilities of the standard normal bootstrap confidence
interval, the basic bootstrap confidence interval, and the percentile
confidence interval. Sample from a normal population and check the
empirical coverage rates for the sample mean. Find the proportion of
times that the confidence intervals miss on the left, and the porportion
of times that the confidence intervals miss on the right.</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) {</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[i])</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  x_bar</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>Sample3 <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mea, sd){</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  samp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, mea, sd)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  samp</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>Analysis3 <span class="ot">&lt;-</span> <span class="cf">function</span>(m, func, Rr, n, mea, sd){</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(boot)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>  nornorm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  norbasi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  norperc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, m, <span class="dv">2</span>)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    Samp <span class="ot">&lt;-</span> <span class="fu">Sample3</span>(n, mea, sd)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>    Skew <span class="ot">&lt;-</span> <span class="fu">boot</span>(Samp, <span class="at">statistic =</span> func, <span class="at">R=</span>Rr)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>    Nor <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(Skew, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    nornorm[i,] <span class="ot">&lt;-</span> Nor<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>    norbasi[i,] <span class="ot">&lt;-</span> Nor<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>    norperc[i,] <span class="ot">&lt;-</span> Nor<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate the coverage probability of a normal distribution</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  norm <span class="ot">&lt;-</span> <span class="fu">mean</span>(nornorm[,<span class="dv">1</span>] <span class="sc">&lt;=</span> s <span class="sc">&amp;</span> nornorm[,<span class="dv">2</span>] <span class="sc">&gt;=</span> s)</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  basi <span class="ot">&lt;-</span> <span class="fu">mean</span>(norbasi[,<span class="dv">1</span>] <span class="sc">&lt;=</span> s <span class="sc">&amp;</span> norbasi[,<span class="dv">2</span>] <span class="sc">&gt;=</span> s)</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  perc <span class="ot">&lt;-</span> <span class="fu">mean</span>(norperc[,<span class="dv">1</span>] <span class="sc">&lt;=</span> s <span class="sc">&amp;</span> norperc[,<span class="dv">2</span>] <span class="sc">&gt;=</span> s)</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate the probability of the left side of the normal distribution</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>  normleft <span class="ot">&lt;-</span> <span class="fu">mean</span>(nornorm[,<span class="dv">1</span>] <span class="sc">&gt;=</span> s )</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  basileft <span class="ot">&lt;-</span> <span class="fu">mean</span>(norbasi[,<span class="dv">1</span>] <span class="sc">&gt;=</span> s )</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>  percleft <span class="ot">&lt;-</span> <span class="fu">mean</span>(norperc[,<span class="dv">1</span>] <span class="sc">&gt;=</span> s )</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Calculate the right side probability of a normal distribution</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>  normright <span class="ot">&lt;-</span> <span class="fu">mean</span>(nornorm[,<span class="dv">2</span>] <span class="sc">&lt;=</span> s )</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>  basiright <span class="ot">&lt;-</span> <span class="fu">mean</span>(norbasi[,<span class="dv">2</span>] <span class="sc">&lt;=</span> s )</span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>  percright <span class="ot">&lt;-</span> <span class="fu">mean</span>(norperc[,<span class="dv">2</span>] <span class="sc">&lt;=</span> s )</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>  analyresu <span class="ot">&lt;-</span> <span class="fu">c</span>(norm, basi, perc, normleft, basileft, percleft, normright, basiright, percright)</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>  analyresu</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>Result3 <span class="ot">&lt;-</span> <span class="cf">function</span>(sd, analyresu){</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>  dnam <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;N ( 0 ,&quot;</span>, <span class="fu">as.character</span>(sd<span class="sc">^</span><span class="dv">2</span>),<span class="st">&quot;)&quot;</span>,<span class="at">seq=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a>  Distribution <span class="ot">&lt;-</span> <span class="fu">c</span>(dnam)</span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true" tabindex="-1"></a>  Type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a>  Left <span class="ot">&lt;-</span> analyresu[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a>  Right <span class="ot">&lt;-</span> analyresu[<span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>]</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a>  P.coverage <span class="ot">&lt;-</span> analyresu[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Distribution, Type, Left, Right, P.coverage)</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>  result</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>mea <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="dv">3</span> </span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a><span class="co"># We can set n, m, R, mea, sd any way we want.</span></span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a>Analyresu <span class="ot">&lt;-</span> <span class="fu">Analysis3</span>(m, skewness, R, n, mea, sd)</span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a>Resu <span class="ot">&lt;-</span> <span class="fu">Result3</span>(sd, Analyresu)</span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span> (Resu, <span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">Distribution</th>
<th align="center">Type</th>
<th align="center">Left</th>
<th align="center">Right</th>
<th align="center">P.coverage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">N ( 0 , 9 )</td>
<td align="center">basic</td>
<td align="center">0.037</td>
<td align="center">0.026</td>
<td align="center">0.937</td>
</tr>
<tr class="even">
<td align="center">N ( 0 , 9 )</td>
<td align="center">norm</td>
<td align="center">0.032</td>
<td align="center">0.025</td>
<td align="center">0.943</td>
</tr>
<tr class="odd">
<td align="center">N ( 0 , 9 )</td>
<td align="center">perc</td>
<td align="center">0.035</td>
<td align="center">0.027</td>
<td align="center">0.938</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the result above, we can find that in the case of the size of
sample is 20, the coverage probabilities of the 3 types of confidence
intervals (the standard normal bootstrap confidence interval, the basic
bootstrap confidence interval, and the percentile confidence interval.)
are very close to 0.9 in the normal distribution (skewness 0). And we
can get the probability that the confidence intervals miss on the left,
and the probability that the confidence intervals miss on the right from
the table. The two probability are both small, and the results of three
methods are very close.</p>
</div>
</div>
<div id="hw6" class="section level2">
<h2>HW6</h2>
<div id="exercises-7.8" class="section level3">
<h3>Exercises 7.8</h3>
<p><strong>Problem</strong> Efron and Tibshirani discuss the scor
(bootstrap) test score data on 88 students who took examinations in five
subjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests
(mechanics, vectors) were closed book and the last three tests (algebra,
analysis, statistics) were open book. Each row of the data frame is a
set of scores <span class="math inline">\((x_{i1},...,x_{i5})\)</span>
for the <span class="math inline">\(i\)</span>-th student.</p>
<p>The five-dimensional scores data have a 5 × 5 covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(λ_1 &gt; ··· &gt; λ_5\)</span>. In principal
components analysis, <span class="math display">\[\theta=\frac{\lambda_1}{\sum^5_{j=1}{\lambda_j}}\]</span>
measures the proportion of variance explained by the first principal
component. Let <span class="math inline">\(\hat{\lambda}_1 &gt; ··· &gt;
\hat{\lambda}_5\)</span> be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. The sample estimate of <span class="math inline">\(\theta\)</span> is <span class="math display">\[\hat{\theta}=\frac{\hat{\lambda}_1}{\sum^5_{j=1}{\hat{\lambda}_j}}\]</span></p>
<p>Now,obtain the jackknife estimates of bias and standard error of
<span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>Solution</strong></p>
<p>The question states that <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>,yet it does not assume any
underlying distribution. We cannot generate MLE without likelihood
function. Therefore,we use empirical estimate of <span class="math inline">\(\Sigma\)</span> instead.A slightly differently
scaled version of the empirical covariance matrix is the MLE when the
underlying distribution is normal.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22004</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>bias_se.jack <span class="ot">&lt;-</span> <span class="cf">function</span>(scor){</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Compute original theta.hat*</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  scor.cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(scor.cov)<span class="sc">$</span>values</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  theta.hat <span class="ot">&lt;-</span> <span class="fu">max</span>(ev)<span class="sc">/</span><span class="fu">sum</span>(ev)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Define function for each jackknife estimate*</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  jack.scor <span class="ot">&lt;-</span> <span class="cf">function</span>(scor,i){</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    d.scor <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i,]</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    d.scor.cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(d.scor)</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    d.ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(d.scor.cov)<span class="sc">$</span>values</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">max</span>(d.ev)<span class="sc">/</span><span class="fu">sum</span>(d.ev)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Iteration*</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  theta.jack<span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n,jack.scor,<span class="at">scor=</span>scor)</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Return list containing jackknife bias &amp; se*</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">bias.jack =</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat),</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">se.jack =</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">bias_se.jack</span>(scor))</span></code></pre></div>
<pre><code>## $bias.jack
## [1] 0.001069139
## 
## $se.jack
## [1] 0.04955231</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>bootstrap)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells 1018196 54.4    1805330 96.5  1805330 96.5
## Vcells 1811647 13.9    8388608 64.0  8388519 64.0</code></pre>
</div>
<div id="exercises-7.11" class="section level3">
<h3>Exercises 7.11</h3>
<p><strong>Problem</strong> In Example 7.18, leave-one-out (n-fold)
cross validation was used to select the best fitting model. Use
leave-two-out cross validation to compare the models.</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22004</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>model.validation <span class="ot">&lt;-</span> <span class="cf">function</span>(y,x,valid.num){</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Step 1:Define a function that computes the sum of error square for different model &amp; validation points(could be leave-k-out)*</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  validerror <span class="ot">&lt;-</span> <span class="cf">function</span>(y,x,index,fun){</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*Delete validation points from sample*</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>    y_d <span class="ot">&lt;-</span> y[<span class="sc">-</span>index]</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>    x_d <span class="ot">&lt;-</span> x[<span class="sc">-</span>index]</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*Choose model according to fun*</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(fun<span class="sc">==</span><span class="st">&quot;linear&quot;</span>){</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>      J <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_d <span class="sc">~</span> x_d)</span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>      yhat <span class="ot">&lt;-</span> J<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x[index]</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(fun<span class="sc">==</span><span class="st">&quot;quadratic&quot;</span>){</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>      J <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_d <span class="sc">~</span> x_d <span class="sc">+</span> <span class="fu">I</span>(x_d<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>      yhat <span class="ot">&lt;-</span> J<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x[index] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> x[index]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(fun<span class="sc">==</span><span class="st">&quot;exponential&quot;</span>){</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>      J <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y_d) <span class="sc">~</span> x_d)</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>      yhat <span class="ot">&lt;-</span> <span class="fu">exp</span>(J<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> x[index])</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span>(fun<span class="sc">==</span><span class="st">&quot;log-log&quot;</span>){</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>      J <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y_d) <span class="sc">~</span> <span class="fu">log</span>(x_d))</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>      yhat <span class="ot">&lt;-</span> <span class="fu">exp</span>(J<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(x[index]))</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;Error!Invalid argument.&quot;</span>)</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>    e <span class="ot">&lt;-</span> <span class="fu">sum</span>((y[index] <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Step 2:leave k out*</span></span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>  num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Obtain all combinations of 2 from n*</span></span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>  valid.index <span class="ot">&lt;-</span> <span class="fu">combn</span>(num,valid.num)</span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*The following sapply function uses dataframe instead of matrix*</span></span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>  valid.index <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(valid.index)</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-48"><a href="#cb65-48" aria-hidden="true" tabindex="-1"></a>  fun_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;linear&quot;</span>,<span class="st">&quot;quadratic&quot;</span>,<span class="st">&quot;exponential&quot;</span>,<span class="st">&quot;log-log&quot;</span>)</span>
<span id="cb65-49"><a href="#cb65-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(name <span class="cf">in</span> fun_names){</span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*For each column of dataframe apply validerror function resulting a vector*</span></span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a>    er <span class="ot">&lt;-</span> <span class="fu">sapply</span>(valid.index,validerror,<span class="at">y=</span>y,<span class="at">x=</span>x,<span class="at">fun=</span>name)</span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*For each name iteration,assign a different name to er*</span></span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">assign</span>(<span class="fu">paste0</span>(name,<span class="st">&quot;.e&quot;</span>),er)</span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">linear validation error</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(linear.e),</span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">quadratic validation error</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(quadratic.e),</span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">exponential validation error</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(exponential.e),</span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">log-log validation error</span><span class="st">`</span><span class="ot">=</span><span class="fu">mean</span>(<span class="st">`</span><span class="at">log-log.e</span><span class="st">`</span>)</span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-65"><a href="#cb65-65" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> magnetic</span>
<span id="cb65-66"><a href="#cb65-66" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> chemical</span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">model.validation</span>(y,x,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## $`linear validation error`
## [1] 39.14455
## 
## $`quadratic validation error`
## [1] 35.74037
## 
## $`exponential validation error`
## [1] 36.90983
## 
## $`log-log validation error`
## [1] 40.93436</code></pre>
<p>It shows that quadratic model has the least leave-two-out error in
consistent with leave-one-out validation.</p>
<p>For leave-one-out error and plots of each models,please refer to book
page 209 ~ page 211.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>DAAG,ironslag)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells 1019974 54.5    1805330 96.5  1805330 96.5
## Vcells 1820493 13.9    8388608 64.0  8388519 64.0</code></pre>
</div>
<div id="exercises-8.2" class="section level3">
<h3>Exercises 8.2</h3>
<p><strong>Problem</strong>Implement the bivariate Spearman rank
correlation test for independence [255] as a permutation test. The
Spearman rank correlation test statistic can be obtained from function
cor with method = “spearman”. Compare the achieved significance level of
the permutation test with the p-value reported by cor.test on the same
samples.</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22004</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>spcor.compare<span class="ot">&lt;-</span> <span class="cf">function</span>(z){</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Function for each permutation statistic*</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  p.spcor <span class="ot">&lt;-</span> <span class="cf">function</span>(z,ix){</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> z[,<span class="dv">1</span>]</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> z[ix,<span class="dv">2</span>]</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">cor.test</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>,<span class="at">exact =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>estimate)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39;*Use boot to sample permutation statistics*</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  obj <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic =</span> p.spcor,<span class="at">R=</span><span class="dv">10000</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(obj<span class="sc">$</span>t0,obj<span class="sc">$</span>t)</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*p-value of spearman&#39;s test using cor.test*</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">pvalue =</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="at">exact =</span> <span class="cn">FALSE</span>)<span class="sc">$</span>p.value,</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#&#39;*p-value of spearman&#39;s test using permutation*</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.pvalue =</span> <span class="fu">mean</span>(<span class="fu">abs</span>(ts)<span class="sc">&gt;=</span><span class="fu">abs</span>(ts[<span class="dv">1</span>]))</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,<span class="dv">1</span>]</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>,<span class="dv">3</span>]</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x,y)</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">spcor.compare</span>(z))</span></code></pre></div>
<pre><code>## $pvalue
## [1] 0.04985095
## 
## $p.pvalue
## [1] 0.04729527</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells 1023724 54.7    1805330 96.5  1805330 96.5
## Vcells 1831113 14.0    8388608 64.0  8388519 64.0</code></pre>
<p><span style="color:red">There is a crucial point of this code we
should pay attention to.</span></p>
<p>In p.spcor function,it returns estimate <span class="math inline">\(\rho\)</span> of cor.test instead of statistic
S.</p>
<p>To explain,let’s recall the definition of S and <span class="math inline">\(\rho\)</span>. For sample <span class="math inline">\((X,Y)\)</span>, denote its rank by <span class="math inline">\((R(X),R(Y))\)</span>,then <span class="math inline">\(d_i=R(X_i)-R(Y_i)\)</span> is the difference
between the two ranks of each observation. Now,we have <span class="math display">\[S=\sum{d^2_i}\]</span> and <span class="math inline">\(\rho=1-\frac{6S}{n^3-n}\)</span>. It shows that S
is non-negative, <span class="math inline">\(\rho \in [-1,1]\)</span>
and S one to one correspond to <span class="math inline">\(\rho\)</span>.</p>
<p>If we use <span class="math inline">\(\rho\)</span> for
hypothesis,the two-sided rejection region is <span class="math inline">\(|\rho|\geq|\rho_0|\)</span>; equivalently,if we
use S instead, we have rejection region <span class="math inline">\(S\leq S_1 \cap S\geq S_2\)</span> where <span class="math inline">\(S_1,S_2&gt;0\)</span> so the region is not
symmetrical which means it’s harder to compute ASL using S than using
<span class="math inline">\(\rho\)</span>.</p>
<p>At last,let’s compare the two p-values. It shows that p-value using
cor.test and using permutation are close.</p>
<p>According to the documentation of cor.test,p-values are computed
using algorithm AS 89 for <span class="math inline">\(n &lt;
1290\)</span> and exact = TRUE, otherwise via the asymptotic <span class="math inline">\(t\)</span> approximation.</p>
<p>Permutation and asymptotic <span class="math inline">\(t\)</span>
approximation are both methods to approximating probability of rho or
equivalently S,so if both estimate precisely,we should expect no great
difference and the minor difference might be mainly caused by
approximation error.</p>
<p>In fact,the reference about Algorithm AS 89 states that when
n&lt;7,n! permutation method is applied to compute probability of S for
all n.When n is larger,n! permutation method takes intractable execution
time,so an Edgeworth series approximation is applied to both reduce
execution time and maintain precision.</p>
</div>
</div>
<div id="hw7" class="section level2">
<h2>HW7</h2>
<div id="exercise-9.4" class="section level3">
<h3>Exercise 9.4</h3>
<p><strong>Problem.</strong> Implement a random walk Metropolis sampler
for generating the standard Laplace distribution, whose density function
is <span class="math display">\[f(x)=\dfrac{1}{2}\text{e}^{-|x|},\quad
x\in\mathbb R.\]</span> For the increment, simulate from a normal
distribution.</p>
<ul>
<li>Compare the chains generated when different variances are used for
the proposal distribution.</li>
<li>Compute the acceptance rates of each chain.</li>
<li>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</li>
</ul>
<p><strong>Solution.</strong> Implementation of a random walk Metropolis
sampler for this problem is as follows.</p>
<ul>
<li>Set <span class="math inline">\(g(\cdot\mid X)\)</span> to the
density of <span class="math inline">\(N(X,\sigma^2)\)</span>.</li>
<li>Generate or initialize <span class="math inline">\(X_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(N(X_{t-1},\sigma^2)\)</span>.</li>
<li>Generate <span class="math inline">\(U\)</span> from <span class="math inline">\(U(0,1)\)</span>.</li>
<li>Compute accept probability <span class="math inline">\(\alpha(X_{t-1},Y)=\dfrac{f(Y)}{f(X_{t-1})}=\dfrac{\text{e}^{-|Y|}}{\text{e}^{-|X_{t-1}|}}=\text{e}^{|X_{t-1}|-|Y|}\)</span>.</li>
<li>If <span class="math inline">\(U\leq\alpha(X_{t-1},Y)\)</span>,
accept <span class="math inline">\(Y\)</span> and set <span class="math inline">\(X_t=Y\)</span>, otherwise set <span class="math inline">\(X_t=X_{t-1}\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in loop.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear memory and set seed</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22034</span>)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>rl.metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sigma: sd of proposal distribution N(xt,sigma^2)</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x0: initial value</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># to calculate acceptance rate</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[t<span class="dv">-1</span>], sigma)</span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[t] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[t<span class="dv">-1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y))) { x[t] <span class="ot">&lt;-</span> y; k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span> }</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> { x[t] <span class="ot">&lt;-</span> x[t<span class="dv">-1</span>] }</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mc =</span> x, <span class="at">acc.prob =</span> k <span class="sc">/</span> N))</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">16</span>)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>acc.prob <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>  rl <span class="ot">&lt;-</span> <span class="fu">rl.metropolis</span>(sigma[i], x0[i], N)</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>  X[i, ] <span class="ot">&lt;-</span> rl<span class="sc">$</span>mc</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>  acc.prob[i] <span class="ot">&lt;-</span> rl<span class="sc">$</span>acc.prob</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>acc.prob</span></code></pre></div>
<pre><code>## [1] 0.8246 0.7034 0.3394 0.0975</code></pre>
<p>As we can see, only the acceptance rate of second chain is much more
favorable. Next we draw the sample path for each chain.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(X[i,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i])),</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(X[i,]))</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next we plot the histogram with the true density besides.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="fl">0.01</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(X[i, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i])), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>),)</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, fx, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plots above, we can draw to the same conclusion to the
previous part, that is, the second chain is more suitable. Next, we
compare the quantiles.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">100</span>, <span class="dv">1</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(z), z) <span class="co"># generate laplace random numbers</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>), <span class="fl">0.95</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(z, p)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> X[, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>Qmc <span class="ot">&lt;-</span> <span class="fu">apply</span>(mc, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, p))</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>QQ <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">round</span>(<span class="fu">cbind</span>(Q, Qmc), <span class="dv">3</span>))</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(QQ) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;True&#39;</span>, <span class="st">&#39;sigma=0.5&#39;</span>, <span class="st">&#39;sigma=1&#39;</span>, <span class="st">&#39;sigma=4&#39;</span>, <span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(QQ)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">True</th>
<th align="right">sigma=0.5</th>
<th align="right">sigma=1</th>
<th align="right">sigma=4</th>
<th align="right">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5%</td>
<td align="right">-2.243</td>
<td align="right">-2.555</td>
<td align="right">-2.115</td>
<td align="right">-2.232</td>
<td align="right">-2.264</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-1.708</td>
<td align="right">-1.543</td>
<td align="right">-1.516</td>
<td align="right">-1.602</td>
<td align="right">-1.660</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-0.936</td>
<td align="right">-0.777</td>
<td align="right">-0.854</td>
<td align="right">-0.903</td>
<td align="right">-0.857</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.572</td>
<td align="right">-0.402</td>
<td align="right">-0.464</td>
<td align="right">-0.511</td>
<td align="right">-0.524</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.278</td>
<td align="right">-0.135</td>
<td align="right">-0.191</td>
<td align="right">-0.229</td>
<td align="right">-0.220</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">0.000</td>
<td align="right">0.078</td>
<td align="right">0.015</td>
<td align="right">-0.010</td>
<td align="right">-0.027</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.278</td>
<td align="right">0.329</td>
<td align="right">0.224</td>
<td align="right">0.193</td>
<td align="right">0.202</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.572</td>
<td align="right">0.660</td>
<td align="right">0.491</td>
<td align="right">0.464</td>
<td align="right">0.527</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">0.936</td>
<td align="right">1.093</td>
<td align="right">0.881</td>
<td align="right">0.881</td>
<td align="right">0.966</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">1.708</td>
<td align="right">1.853</td>
<td align="right">1.530</td>
<td align="right">1.636</td>
<td align="right">1.581</td>
</tr>
<tr class="odd">
<td align="left">95%</td>
<td align="right">2.243</td>
<td align="right">2.657</td>
<td align="right">2.197</td>
<td align="right">2.448</td>
<td align="right">2.333</td>
</tr>
</tbody>
</table>
<p>As we can see, the quantiles of the second or third chain are close
to the true quantiles of standard Laplace distribution.</p>
<hr />
<p>Finally, we use the Gelman-Rubin method to monitor convergence of the
chain. Suppose we are interested in the mean, i.e. <span class="math inline">\(\phi_{it}\)</span> denotes the sample mean until
the <span class="math inline">\(t\)</span>-th replicates in the <span class="math inline">\(i\)</span>-th chain.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(phi); n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  phi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  phi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ergodic mean plot</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  phi[i,] <span class="ot">&lt;-</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&#39;Index&#39;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="fu">lines</span>(phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col =</span> i) }</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of R_hat</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Either from the ergodic mean plot, or from the plot of <span class="math inline">\(\hat{R}\)</span>, we could know the chain has
converged.</p>
</div>
<div id="exercise-9.7" class="section level3">
<h3>Exercise 9.7</h3>
<p><strong>Problem.</strong> Implement a Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span>
with zero means, unit standard deviations, and correlation <span class="math inline">\(0.9\)</span>.</p>
<ul>
<li>Plot the generated sample aftering discarding a suitable burn-in
sample.</li>
<li>Use the Gelman-Rubin method to monitor convergence of the chain, and
run the chain until it converges approximately to the target
distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</li>
<li>Fit a simple linear regression model <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> to the sample and
check the residuals of the model for normality and constant
variance.</li>
</ul>
<p><strong>Solution.</strong> To generate a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span> from <span class="math inline">\(N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)\)</span>,
we notice that <span class="math display">\[\begin{align*}
X\mid Y=y&amp;\sim
N\left(\mu_1+\rho\dfrac{\sigma_1}{\sigma_2}(y-\mu_2),(1-\rho^2)\sigma_1^2\right),\\
Y\mid X=x&amp;\sim
N\left(\mu_2+\rho\dfrac{\sigma_2}{\sigma_1}(x-\mu_1),(1-\rho^2)\sigma_2^2\right).
\end{align*}\]</span></p>
<p>So we implement the Gibbs sampler below and plot the generated sample
aftering discarding a suitable burn-in sample.</p>
<ul>
<li>Set initial value <span class="math inline">\(X_1\)</span>, <span class="math inline">\(Y_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(X_t\sim f_{X|Y}(x\mid
Y_{t-1})\)</span>.</li>
<li>Generate <span class="math inline">\(Y_t\sim f_{Y|X}(y\mid
X_t)\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in the loop.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear memory and set seed</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rm(list = ls())</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22004</span>)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>rbn.metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, rho, initial, N) {</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu, sigma, rho: parameter of bivariate normal distribution.</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initial: initial value</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">1</span>]; Y[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">2</span>]</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> Y[i<span class="dv">-1</span>]</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho <span class="sc">*</span> (y <span class="sc">-</span> mu[<span class="dv">2</span>]) <span class="sc">*</span> sigma[<span class="dv">1</span>] <span class="sc">/</span> sigma[<span class="dv">2</span>]</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>    X[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s[<span class="dv">1</span>])</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i]</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho <span class="sc">*</span> (x <span class="sc">-</span> mu[<span class="dv">1</span>]) <span class="sc">*</span> sigma[<span class="dv">2</span>] <span class="sc">/</span> sigma[<span class="dv">1</span>]</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>    Y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s[<span class="dv">2</span>])</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y))</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a>XY <span class="ot">&lt;-</span> <span class="fu">rbn.metropolis</span>(mu, sigma, rho, mu, N)</span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> XY<span class="sc">$</span>X[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]; Y <span class="ot">&lt;-</span> XY<span class="sc">$</span>Y[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X, Y, <span class="at">xlab =</span> <span class="fu">bquote</span>(X[t]), <span class="at">ylab =</span> <span class="fu">bquote</span>(Y[t]),</span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">ylim =</span> <span class="fu">range</span>(Y))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(<span class="fu">cbind</span>(X, Y))</span></code></pre></div>
<pre><code>##           X         Y
## X 1.0146254 0.9128316
## Y 0.9128316 1.0161113</code></pre>
<p>From the result above, we can conclude that the chain has converged
for the sample covariance matrix is close to the truth. Next, we use
different initial values to monitor the convergence of two chains
(i.e. <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span>), with <span class="math inline">\(\phi_{it}\)</span> denotes the sample mean until
the <span class="math inline">\(t\)</span>-th replicates in the <span class="math inline">\(i\)</span>-th cain, respectively. Notice that we
calculate the sample mean of <span class="math inline">\(X_tY_t\)</span>
for monitering the convergence of covariance.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> k)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>Xmc <span class="ot">&lt;-</span> Ymc <span class="ot">&lt;-</span> XYmc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> N)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  XY <span class="ot">&lt;-</span> <span class="fu">rbn.metropolis</span>(mu, sigma, rho, x0[,i], N)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  Xmc[i,] <span class="ot">&lt;-</span> XY<span class="sc">$</span>X; Ymc[i,] <span class="ot">&lt;-</span> XY<span class="sc">$</span>Y</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  XYmc[i,] <span class="ot">&lt;-</span> Xmc[i,] <span class="sc">*</span> Ymc[i,]</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ergodic mean plot</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>cal_phi <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(phi)) {</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>    phi[i,] <span class="ot">&lt;-</span> phi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(phi))</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(phi)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>phiX <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(Xmc)</span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>phiY <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(Ymc)</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>phiXY <span class="ot">&lt;-</span> <span class="fu">cal_phi</span>(XYmc)</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>plot_erg_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(phi, rg) {</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> rg,</span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="at">ylab =</span> <span class="fu">bquote</span>(phi))</span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> { <span class="fu">lines</span>(phi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">col =</span> i) }</span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiX, <span class="at">rg =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiY, <span class="at">rg =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_erg_mean</span>(phiXY, <span class="at">rg =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(phi)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(phi); n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  phi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(phi)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.means)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  phi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(phi.w)</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">+</span> B <span class="sc">/</span> n</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot of R_hat</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>plot_R_hat <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>  rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N) {</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>    rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.25</span>))</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiX)</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiY)</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_R_hat</span>(phiXY)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
Either from the ergodic mean plot, or from the plot of <span class="math inline">\(\hat{R}\)</span>, we could know the chain has
converged.</p>
<hr />
<p>Finally, we fit the simple linear regression model.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>lm.fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.fit)</span></code></pre></div>
<pre><code>
Call:
lm(formula = Y ~ X)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.58908 -0.29337 -0.00108  0.29786  1.76136 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.0008176  0.0046580  -0.176    0.861    
X            0.8996734  0.0046199 194.737   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4415 on 8998 degrees of freedom
Multiple R-squared:  0.8082,    Adjusted R-squared:  0.8082 
F-statistic: 3.792e+04 on 1 and 8998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The coefficients of the fitted model <span class="math inline">\(0.8996734\)</span> is close to the true value
<span class="math inline">\(0.9\)</span>. Then we check the residuals of
the model for normality and constant variance. Theoritically, the
variance of <span class="math inline">\(e\)</span> is <span class="math display">\[\textsf{Var}(e)=\textsf{Var}(Y-0.9X)=\textsf{Var}(Y)+0.9^2\textsf{Var}(X)-2\times0.9\textsf{Cov}(X,Y)=0.19.\]</span></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> lm.fit<span class="sc">$</span>residuals</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>qx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.01</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(e, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(qx, <span class="fu">dnorm</span>(qx, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="fl">0.19</span>)), <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(e)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(e, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the histogram and QQ-plot, we can say that the residual is from
the normal distribution with constant variance.</p>
</div>
</div>
<div id="hw8" class="section level2">
<h2>HW8</h2>
<div id="exercise-1" class="section level3">
<h3>Exercise 1</h3>
<p><strong>Problem.</strong> Testing the mediating effects. Consider the
models <span class="math display">\[M=a_M+\alpha X+e_M,\]</span> <span class="math display">\[Y=a_Y+\beta M+\gamma X+e_Y,\]</span> <span class="math display">\[e_M,e_Y \sim N(0,1).\]</span> And <span class="math inline">\(e_M,e_Y\)</span> are independent.</p>
<p>The hypothesis testing is <span class="math display">\[H_0:\alpha\beta=0\quad
H_1:\alpha\beta\neq0.\]</span></p>
<p>The test statistics is <span class="math display">\[T=\frac{\hat{\alpha}\hat{\beta}}{\hat{se}(\hat{\alpha}\hat{\beta})}=\frac{\hat{\alpha}\hat{\beta}}{\sqrt{\hat{\alpha}^2\hat{s}_\beta^2+\hat{\beta}^2\hat{s}_\alpha^2}}\]</span>
while <span class="math inline">\(s_\alpha\)</span> and <span class="math inline">\(s_\beta\)</span> are the standard deviations of
<span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> respectively.</p>
<p><strong>Solution.</strong></p>
<p>We can implement the permutation test under the following
conditions:</p>
<ul>
<li>Condition <span class="math inline">\(1\)</span>: <span class="math inline">\(\alpha=0,\beta\neq0\)</span>. In this situation,
<span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span> are independent, which means that any
permutation of <span class="math inline">\(X\)</span> and <span class="math inline">\(M\)</span> are independent;</li>
<li>Condition <span class="math inline">\(2\)</span>: <span class="math inline">\(\beta=0,\alpha\neq0\)</span>. In this situation,
<span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> are independent, which means that any
permutation of <span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> are independent;</li>
<li>Condition <span class="math inline">\(3\)</span>: <span class="math inline">\(\alpha=0,\beta=0\)</span>. In this situation,
<ul>
<li><span class="math inline">\(M\)</span> and <span class="math inline">\(X\)</span> are independent;</li>
<li><span class="math inline">\(M\)</span> and <span class="math inline">\(Y\)</span> are independent.</li>
</ul></li>
</ul>
<p>Set the real values are</p>
<ul>
<li><span class="math inline">\(\alpha=0,\beta=0,\gamma=1,a_M=0.5,a_Y=1\)</span></li>
<li><span class="math inline">\(\alpha=0,\beta=1,\gamma=1,a_M=0.5,a_Y=1\)</span></li>
<li><span class="math inline">\(\alpha=1,\beta=0,\gamma=1,a_M=0.5,a_Y=1\)</span></li>
</ul>
<p>Then implement permutation test for each situation of parameter under
the three conditions above.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The function to generate the random sample</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>RSample <span class="ot">&lt;-</span> <span class="cf">function</span>(n,alpha,beta){</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> <span class="dv">1</span>;aM <span class="ot">&lt;-</span> <span class="fl">0.5</span>;aY <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> aM<span class="sc">+</span>alpha<span class="sc">*</span>X<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> aY<span class="sc">+</span>beta<span class="sc">*</span>M<span class="sc">+</span>gamma<span class="sc">*</span>X<span class="sc">+</span><span class="fu">rnorm</span>(n)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(X,M,Y))</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co"># The function of test statistics computation</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>Ttest <span class="ot">&lt;-</span> <span class="cf">function</span>(X,M,Y){</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  fit1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(M<span class="sc">~</span>X))</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  fit2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>X<span class="sc">+</span>M))</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> fit1<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  sea <span class="ot">&lt;-</span> fit1<span class="sc">$</span>coefficients[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> fit2<span class="sc">$</span>coefficients[<span class="dv">3</span>,<span class="dv">1</span>]</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>  seb <span class="ot">&lt;-</span> fit2<span class="sc">$</span>coefficients[<span class="dv">3</span>,<span class="dv">2</span>]</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a<span class="sc">*</span>b<span class="sc">/</span>((a<span class="sc">*</span>seb)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>(b<span class="sc">*</span>sea)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a><span class="co"># The function to implement the test hypothesis</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>Imptest <span class="ot">&lt;-</span> <span class="cf">function</span>(N,n,X,M,Y,T0){</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a>  T1 <span class="ot">&lt;-</span> T2 <span class="ot">&lt;-</span> T3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Condition 1</span></span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size=</span>n, <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> X[n1];M1 <span class="ot">&lt;-</span> M[n2];Y1 <span class="ot">&lt;-</span> Y[n2]</span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a>    T1[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X1,M1,Y1)</span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Condition 2</span></span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> X[n1];M2 <span class="ot">&lt;-</span> M[n1];Y2 <span class="ot">&lt;-</span> Y[n2]</span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a>    T2[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X2,M2,Y2)</span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Condition 3</span></span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a>    n1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a>    n2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a>    M3 <span class="ot">&lt;-</span> M[n1];X3 <span class="ot">&lt;-</span> X[n2];Y3 <span class="ot">&lt;-</span> Y[n2]</span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a>    T3[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X3,M3,Y3)</span>
<span id="cb88-46"><a href="#cb88-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-47"><a href="#cb88-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The p-value of Condition1</span></span>
<span id="cb88-48"><a href="#cb88-48" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,T1))<span class="sc">&gt;</span><span class="fu">abs</span>(T0))</span>
<span id="cb88-49"><a href="#cb88-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The p-value of Condition2</span></span>
<span id="cb88-50"><a href="#cb88-50" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,T2))<span class="sc">&gt;</span><span class="fu">abs</span>(T0))</span>
<span id="cb88-51"><a href="#cb88-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The p-value of Condition3</span></span>
<span id="cb88-52"><a href="#cb88-52" aria-hidden="true" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(T0,T3))<span class="sc">&gt;</span><span class="fu">abs</span>(T0))</span>
<span id="cb88-53"><a href="#cb88-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(p1,p2,p3))</span>
<span id="cb88-54"><a href="#cb88-54" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-55"><a href="#cb88-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-56"><a href="#cb88-56" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># The number of simulation</span></span>
<span id="cb88-57"><a href="#cb88-57" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># The number of random sample</span></span>
<span id="cb88-58"><a href="#cb88-58" aria-hidden="true" tabindex="-1"></a>T0 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb88-59"><a href="#cb88-59" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb88-60"><a href="#cb88-60" aria-hidden="true" tabindex="-1"></a><span class="co"># The real values of parameters</span></span>
<span id="cb88-61"><a href="#cb88-61" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>);beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb88-62"><a href="#cb88-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-63"><a href="#cb88-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb88-64"><a href="#cb88-64" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">RSample</span>(n,alpha[i],beta[i])</span>
<span id="cb88-65"><a href="#cb88-65" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> result[[<span class="dv">1</span>]]</span>
<span id="cb88-66"><a href="#cb88-66" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> result[[<span class="dv">2</span>]]</span>
<span id="cb88-67"><a href="#cb88-67" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> result[[<span class="dv">3</span>]]</span>
<span id="cb88-68"><a href="#cb88-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The original value of test statistics</span></span>
<span id="cb88-69"><a href="#cb88-69" aria-hidden="true" tabindex="-1"></a>  T0[i] <span class="ot">&lt;-</span> <span class="fu">Ttest</span>(X,M,Y)</span>
<span id="cb88-70"><a href="#cb88-70" aria-hidden="true" tabindex="-1"></a>  p[i,] <span class="ot">&lt;-</span> <span class="fu">Imptest</span>(N,n,X,M,Y,T0[i])</span>
<span id="cb88-71"><a href="#cb88-71" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Output the table of p-values for the permutation tests above.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Result reporting</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Condition 1&quot;</span>,<span class="st">&quot;Condition 2&quot;</span>,<span class="st">&quot;Condition 3&quot;</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(p) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;alpha=0,beta=0&quot;</span>,<span class="st">&quot;alpha=0,beta=1&quot;</span>,<span class="st">&quot;alpha=1,beta=0&quot;</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>##                Condition 1 Condition 2 Condition 3
## alpha=0,beta=0  0.77022977   0.4045954 0.635364635
## alpha=0,beta=1  0.02097902   0.0000000 0.001998002
## alpha=1,beta=0  0.68331668   0.7032967 0.479520480</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the memory of the variables</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>According to the output, none of the permutation tests under the
three conditions can control the type I error very well.</p>
</div>
<div id="exercise-2" class="section level3">
<h3>Exercise 2</h3>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22004</span>)</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The function to solve the alpha</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>solve <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">50</span>,<span class="dv">0</span>))</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span>])</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span>;b1 <span class="ot">&lt;-</span> <span class="dv">0</span>;b2 <span class="ot">&lt;-</span> <span class="dv">1</span>;b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(f0))</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f0)){</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>  alpha[i] <span class="ot">&lt;-</span> <span class="fu">solve</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">rbind</span>(f0,alpha)</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;f0&quot;</span>,<span class="st">&quot;alpha&quot;</span>)</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>##           [,1]     [,2]     [,3]      [,4]
## f0     0.10000  0.01000  0.00100   0.00010
## alpha -3.16604 -6.06183 -8.72105 -11.26401</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the scatter plot of f0 and alpha</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(f0,alpha,<span class="at">main=</span><span class="st">&quot;The scatter plot of f0 and alpha&quot;</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw the scatter plot of log(f0) and alpha</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(f0),alpha,<span class="at">main=</span><span class="st">&quot;The scatter plot of log(f0) and alpha&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the memory of the variables</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
<p>According to the plots, we can get that the relationship between
<span class="math inline">\(\log(f_0)\)</span> and <span class="math inline">\(\alpha\)</span> is linear.</p>
</div>
</div>
<div id="hw9" class="section level2">
<h2>HW9</h2>
<div id="exercise-1-1" class="section level3">
<h3>Exercise 1</h3>
<p><strong>Problem.</strong> <span class="math display">\[X_1, \dots,
X_n \overset{iid}{\sim}Exp(\lambda)\]</span></p>
<p>For some reasons, we only know that <span class="math inline">\(X_i\)</span> belongs to an interval <span class="math inline">\((u_i,v_i),i=1,\dots,n\)</span>, where <span class="math inline">\(u_i&lt;v_i\)</span> and both are known
constants.</p>
<p>(1). Obtain the estimators by observed likelihood function and ME
algorithm, then prove that they are equivalents.</p>
<p>(2). Suppose that we have observations of intervals <span class="math display">\[(11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3)\]</span>
Now program to compute the numerical solutions of both methods.</p>
<p><strong>Solution 1.1.</strong></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span></code></pre></div>
<p>rm(list=ls()) invisible(gc())</p>
<p>(1). MLE</p>
<p><span class="math display">\[\begin{gather}
L_o\left(\lambda;u,v\right)=\prod_{i=1}^{n}{P_\lambda\left(u_i\le x_i\le
v_i\right)}=\prod_{i=1}^{n}{(e^{-\lambda u_i}-e^{-\lambda v_i})}\\

l_o\left(\lambda;u,v\right)=logL_o\left(\lambda;u,v\right)=\sum_{i=1}^{n}log\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right)\\

\frac{\partial
l_o\left(\lambda;u,v\right)}{\partial\lambda}=\sum_{i=1}^{n}\frac{v_ie^{-\lambda
v_i}-u_ie^{-\lambda u_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}

\end{gather}\]</span></p>
<p>Now, let’s compute its second order derivative.</p>
<p><span class="math display">\[\begin{align}
\frac{\partial^2l_o\left(\lambda;u,v\right)}{\partial\lambda^2}&amp;=\sum_{i=1}^{n}{-\frac{\left(v_ie^{-\lambda
v_i}-u_ie^{-\lambda u_i}\right)^2}{\left(e^{-\lambda u_i}-e^{-\lambda
v_i}\right)^2}}
+\sum_{i=1}^{n}\frac{u_i^2e^{-\lambda u_i}-v_i^2e^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}\\

&amp;=\sum_{i=1}^{n}\frac{-\left(v_ie^{-\lambda v_i}-u_ie^{-\lambda
u_i}\right)^2+\left(e^{-\lambda u_i}-e^{-\lambda
v_i}\right)(u_i^2e^{-\lambda u_i}-v_i^2e^{-\lambda
v_i})}{\left(e^{-\lambda u_i}-e^{-\lambda v_i}\right)^2}\\

&amp;=\sum_{i=1}^{n}\frac{-\left(v_i^2e^{-2\lambda v_i}+u_i^2e^{-\lambda
u_i}-2u_iv_ie^{-\lambda\left(u_i+v_i\right)}\right)+u_i^2e^{-2\lambda
u_i}-u_i^2e^{-\lambda\left(u_i+v_i\right)}-v_i^2e^{-\lambda\left(u_i+v_i\right)}+v_i^2e^{-2\lambda
v_i}}{\left(e^{-\lambda u_i}-e^{-\lambda v_i}\right)^2}\\

&amp;=\sum_{i=1}^{n}\frac{-\left(u_i-v_i\right)^2e^{-\lambda\left(u_i+v_i\right)}}{\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right)^2}&lt;0
\end{align}\]</span></p>
<p>Hence the MLE is the root of <span class="math inline">\(\frac{\partial
l_o\left(\lambda;u,v\right)}{\partial\lambda}=0\)</span>.</p>
<p>(2). EM algorithms</p>
<p><span class="math display">\[\begin{gather}
L_c\left(\lambda;x\right)=\prod_{i=1}^{n}{\lambda e^{-\lambda
x_i}}=\lambda^ne^{-\lambda\sum_{i=1}^{n}x}\\

l_c\left(\lambda;x\right)=nlog\lambda-\lambda\sum_{i=1}^{n}x_i\\

E\left[l_c\left(\lambda;x\right)\middle|x_i\in\left[u_i,v_i\right]\right]=E\left[nlog\lambda-\lambda\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]
=nlog\lambda-\lambda
E\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]\\

\frac{\partial
E\left[l_c\left(\lambda;x\right)\middle|x_i\in\left[u_i,v_i\right]\right]}{\partial\lambda}=\frac{n}{\lambda}-E\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]=0

\end{gather}\]</span></p>
<p>Hence the iteration</p>
<p><span class="math display">\[\frac{n}{\lambda_{(t)}}=E_{\lambda_{(t-1)}}\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]\]</span></p>
<p><span class="math display">\[\begin{align}

E_{\lambda}\left[\sum_{i=1}^{n}x_i\middle|x_i\in\left[u_i,v_i\right]\right]&amp;=\sum_{i=1}^{n}{\frac{1}{e^{-\lambda
u_i}-e^{-\lambda v_i}}\int_{u_i}^{v_i}{\lambda x e^{-\lambda x}dx}}\\

&amp;=\sum_{i=1}^{n}\frac{\left[-xe^{-\lambda
x}\right]_{u_i}^{v_i}-\left[\frac{1}{\lambda}e^{-\lambda
x}\right]_{u_i}^{v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}\\

&amp;=-\sum_{i=1}^{n}\frac{v_ie^{-\lambda v_i}-u_ie^{-\lambda
u_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}+\frac{1}{\lambda}\sum_{i=1}^{n}\frac{-\left[e^{-\lambda
x}\right]_{u_i}^{v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}\\

&amp;=-\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}+\frac{n}{\lambda}

\end{align}\]</span></p>
<p>We have</p>
<p><span class="math display">\[\frac{n}{\lambda_{(t)}}=-\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda_{(t-1)}}+\frac{n}{\lambda_{(t-1)}}\]</span></p>
<p>If <span class="math inline">\(\lambda_{(t)}\)</span> converges to a
limit value <span class="math inline">\(\lambda^*\)</span>, then <span class="math inline">\(\lambda^*\)</span> is the estimator produced by EM
algorithm.</p>
<p>(3). Proof</p>
<p>If the estimator <span class="math inline">\(\lambda^*\)</span> is
also a fixed point, which means</p>
<p><span class="math display">\[\frac{n}{\lambda^*}=-\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda^*}+\frac{n}{\lambda^*}\]</span></p>
<p>then we have <span class="math display">\[\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda^*}=0\]</span>
Hence the MLE estimator by observed data likelihood function is also
<span class="math inline">\(\lambda^*\)</span>.</p>
<p>Now, the question comes to prove that Banach’s Fixed Point Theory
holds.</p>
<p>Note that</p>
<p><span class="math display">\[\begin{align}
\frac{n}{\lambda^*}&amp;=-\frac{\partial
l\left(\lambda;u,v\right)}{\partial\lambda}\bigg|_{\lambda=\lambda^*}+\frac{n}{\lambda^*}\\

&amp;=-\sum_{i=1}^{n}\frac{v_ie^{-\lambda^* v_i}-u_ie^{-\lambda^*
u_i}}{e^{-\lambda^* u_i}-e^{-\lambda^* v_i}}+\frac{n}{\lambda^*}\\
\end{align}\]</span></p>
<p>Denote <span class="math inline">\(1/\lambda^*\)</span> by <span class="math inline">\(k\)</span>, we have</p>
<p><span class="math display">\[
k=g(k)=\frac{1}{n}\sum_{i=1}^{n}\frac{u_ie^{- u_i/k}-v_ie^{-
v_i/k}}{e^{-u_i/k}-e^{-v_i/k}}+k
\]</span></p>
<p>If <span class="math inline">\(g(k)\)</span> is both self mapping and
contraction mapping, then Banach’s Fixed Point Theory holds.</p>
<p><strong>A. Self mapping</strong></p>
<p>By Cauchy’s Mean Value Theorem, we have</p>
<p><span class="math display">\[\begin{align}
\frac{ve^{-v/k}-ue^{-u/k}}{e^{-u/k}-e^{-v/k}}

=\frac{e^{-m/k}-m/ke^{-m/k}}{-e^{-m/k}/k}

=-k+m, \quad m\in[u,v]
\end{align}\]</span></p>
<p>hence</p>
<p><span class="math display">\[\begin{equation}
k=g(k)=\frac{1}{n}(-nk+\sum^n_{i=1}m_i)+k=\sum^n_{i=1}m_i/n=\bar{m} \in
[min\{u_i\}_{i=1,\dots,n},max\{v_i\}_{i=1,\dots,n}]\\
\end{equation}\]</span></p>
<p>PS: <span class="math inline">\(m_i\)</span> depends on <span class="math inline">\(\lambda\)</span> which means change of <span class="math inline">\(\lambda\)</span> will force <span class="math inline">\(m_i\)</span> to differ.</p>
<p>It shows that the codomain is the subset of domain <span class="math inline">\(k \in R^+\)</span>, so <span class="math inline">\(g(k)\)</span> is a self mapping.</p>
<p><strong>B. Contraction mapping</strong><span style="color:red">(There
might be a problem here)</span></p>
<p>For all <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span> in domain, we need to prove that
there exists <span class="math inline">\(0\leq a&lt;1\)</span> such
that</p>
<p><span class="math display">\[|g(k_1)-g(k_2)|\leq
a|k_1-k_2|\]</span></p>
<p>By Lagrange mean value theorem, for all <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span> in domain, <span class="math display">\[|g(k_1)-g(k_2)|=g&#39;(\eta)|k_1-k_2|,\quad
\eta\in[k_1,k_2]\]</span></p>
<p>If <span class="math inline">\(|g&#39;(k)|\leq a&lt;1\)</span>, then
<span class="math inline">\(g(k)\)</span> is contraction mapping.</p>
<p><span class="math display">\[\begin{equation}
g&#39;(k)= 1-\frac{1}{n}\sum^n_{i=1}\frac{e^{-(u+v)/k}
\left(\frac{u-v}{k}\right)^2}{(e^{-u/k}-e^{-v/k})^2}
\end{equation}\]</span></p>
<p>For any finite domain <span class="math inline">\(k\in
[k_1,k_2]\supset
[min\{u_i\}_{i=1,\dots,n},max\{v_i\}_{i=1,\dots,n}]\)</span>,</p>
<p>there exists a upper bound <span class="math inline">\(a\)</span>
that is less than 1 such that <span class="math inline">\(g&#39;(k)\leq
a&lt;1\)</span></p>
<p>Now we only need to prove that</p>
<p><span class="math display">\[
\frac{e^{-(u+v)/k}
\left(\frac{u-v}{k}\right)^2}{(e^{-u/k}-e^{-v/k})^2}&lt;=2-\varepsilon,\quad
0&lt;\varepsilon&lt;1
\]</span> <span class="math display">\[\begin{equation}
\frac{e^{-\left(u+v\right)/k}\left(\frac{u-v}{k}\right)^2}{\left(e^{-u/k}-e^{-v/k}\right)^2}=\frac{e^{-\left(u+v\right)/k}\left(\frac{u-v}{k}\right)^2}{e^{-2v/k}\left(e^{-\left(u+v\right)/k}-1\right)^2}=\frac{e^{-\left(u-v\right)/k}\left(\frac{u-v}{k}\right)^2}{\left(e^{-\left(u-v\right)/k}-1\right)^2}
\end{equation}\]</span></p>
<p>Denote <span class="math inline">\(x=-\frac{u-v}{k}&gt;0\)</span>,
then we need to prove <span class="math display">\[
f(x)=\frac{e^xx^2}{\left(e^x-1\right)^2}&lt;2
\]</span> Clearly, <span class="math inline">\(f(x)&gt;0\)</span>, <span class="math inline">\(\lim\limits_{x\to0^+}f(x)=1(x \sim
e^x-1)\)</span>, and <span class="math inline">\(\lim\limits_{x\to+\infty}f(x)=0\)</span></p>
<p>If we can prove that <span class="math inline">\(f(x)\)</span> is
monotonically decreasing, then the proof is complete.</p>
<p><span class="math display">\[\begin{align}
lnf(x)&amp;=x+2lnx+2ln(e^x-1)\\

(lnf(x))&#39;&amp;=\frac{f&#39;(x)}{f(x)}=1+\frac{2}{x}-2\frac{e^x}{e^x-1}\\
&amp;=-1+2\left(\frac{1}{x}-\frac{1}{e^x-1}\right)\\
&amp;=-1+2(\frac{e^x-1-x}{x(e^x-1)})\\
&amp;=-1+2\frac{x^2/2!+x^3/3!+···+x^n/n!+···}{x^2+x^3/2!+···+x^n/(n-1)!+···}
\end{align}\]</span></p>
<p>By sugar water inequality that</p>
<p>for any <span class="math inline">\(a&gt;0,b&gt;0,m&gt;0,n&gt;0\)</span>,</p>
<p><span class="math display">\[\begin{equation}
\text{if} \quad
\frac{n}{m}&lt;\frac{a}{b}\\
\text{then},\quad\frac{a+n}{b+m}&lt;\frac{a}{b}\\

\text{if} \quad
\frac{n}{m}&gt;\frac{a}{b}\\
\text{then},\quad\frac{a+n}{b+m}&gt;\frac{a}{b}
\end{equation}\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[\begin{equation}
\frac{x^2/2!+x^3/3!+···+x^n/n!+···}{x^2+x^3/2!+···+x^n/(n-1)!+···}&lt;\frac{x^2/2!}{x^2}=\frac{1}{2}\\

f&#39;(x)&lt;0
\end{equation}\]</span></p>
<p>Thus complete the proof.</p>
<p><strong>Solution 1.2.</strong></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*lower bound*</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*upper bound*</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*Observed data likelihood*</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>o.likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)<span class="sc">-</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(o.likelihood,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>),<span class="at">extendInt =</span> <span class="st">&quot;yes&quot;</span>)</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">unlist</span>(solution),<span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>MLE <span class="ot">&lt;-</span> k[<span class="dv">1</span>]</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*EM algorithm*</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a>lambda.old <span class="ot">&lt;-</span> <span class="fl">0.0000000001</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>tol <span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps</span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">10</span>)</span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">length</span>(u)<span class="sc">/</span>(<span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda.old<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda.old<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda.old<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda.old<span class="sc">*</span>v)))<span class="sc">+</span><span class="fu">length</span>(u)<span class="sc">/</span>lambda.old)</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="fu">abs</span>(lambda <span class="sc">-</span> lambda.old)<span class="sc">/</span>lambda.old) <span class="sc">&lt;</span> tol) <span class="cf">break</span></span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>  lambda.old <span class="ot">&lt;-</span> lambda</span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The MLE is 0.07198.</p>
<p>The EM estimator is 0.07197.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span></code></pre></div>
</div>
<div id="exercise-2.1.3" class="section level3">
<h3>Exercise 2.1.3</h3>
<p><strong>Problem.</strong> Why do you need to use unlist() to convert
a list to an atomic vector? Why doesn’t as.vector() work?</p>
<p><strong>Solution</strong></p>
<p>Unlist strips list off its nested structure resulting that of an
atomic vector.</p>
<p>List is a vector and as.vector does not change the structure of a
vector.</p>
<p>Apply as.vector to a list (vector) will still result a
vector(list).</p>
<p><strong>Problem.</strong> Why is 1 == “1” true? Why is -1 &lt; FALSE
true? Why is “one” &lt; 2 false?</p>
<p><strong>Solution</strong></p>
<p>When using operators like “==” and ”&lt;”, they will coerce their
arguments to the same type first by the coercion hierarchy.</p>
<p>In these cases, character, double and character respectively.</p>
<p>For “one” &lt; 2, it is equivalent to “one” &lt; “2” and “one” is
after “2” in ASCII.</p>
</div>
<div id="exercise-2.3.1" class="section level3">
<h3>Exercise 2.3.1</h3>
<p><strong>Problem.</strong> What does dim() return when applied to a
vector?</p>
<p><strong>Solution</strong></p>
<p>NULL</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(v)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span></code></pre></div>
<p><strong>Problem.</strong> If is.matrix(x) is TRUE, what will
is.array(x) return?</p>
<p><strong>Solution</strong></p>
<p>It will return TRUE because matrix is an array in the special case of
2 dimensions.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>,<span class="at">byrow=</span>T)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">is.matrix</span>(m)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.array</span>(m)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span></code></pre></div>
</div>
<div id="exercise-2.4.5" class="section level3">
<h3>Exercise 2.4.5</h3>
<p><strong>Problem.</strong> What attributes does a data frame
possess?</p>
<p><strong>Solution.</strong></p>
<p>A data frame possesses attributes names, class, row.names.</p>
<p>It also has attributes like dim and dimnames which inherit from
corresponding matrix.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*atrributes of dataframe*</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="at">b=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>))</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(d)</span></code></pre></div>
<pre><code>## $names
## [1] &quot;a&quot; &quot;b&quot;
## 
## $class
## [1] &quot;data.frame&quot;
## 
## $row.names
## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*atrributes of matrix*</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">pi =</span> pi)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(x)</span></code></pre></div>
<pre><code>## $dim
## [1] 3 2
## 
## $dimnames
## $dimnames[[1]]
## NULL
## 
## $dimnames[[2]]
## [1] &quot;a&quot;  &quot;pi&quot;</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span></code></pre></div>
<p><strong>Problem.</strong> What does as.matrix() do when applied to a
data frame with columns of different types?</p>
<p><strong>Solution.</strong></p>
<p>The method for data frames will return a character matrix if there is
only atomic columns and any non-(numeric/logical/complex) column,
applying as.vector to factors and format to other non-character
columns.</p>
<p>Otherwise, the usual coercion hierarchy (logical &lt; integer &lt;
double &lt; complex) will be used, e.g., all-logical data frames will be
coerced to a logical matrix, mixed logical-integer will give a integer
matrix, etc.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y =</span> <span class="fu">I</span>(<span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>), <span class="fu">c</span>(F,T,F,T))))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>##   x            y
## 1 1         1, 2
## 2 2      a, b, c
## 3 3 FALSE, T....</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(df)</span></code></pre></div>
<pre><code>##      x y          
## [1,] 1 integer,2  
## [2,] 2 character,3
## [3,] 3 logical,4</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span></code></pre></div>
<p><strong>Problem.</strong> Can you have a data frame with 0 rows? What
about 0 columns?</p>
<p><strong>Solution.</strong></p>
<p>Yes</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*dataframe with 0 rows and 2 cols*</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">1</span>),<span class="at">b=</span><span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">1</span>))</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(d1)</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;*dataframe with 2 rows and 0 cols*</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">row.names=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>))</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(d2)</span></code></pre></div>
<pre><code>## [1] 2 0</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">gc</span>())</span></code></pre></div>
</div>
</div>
<div id="hw10" class="section level2">
<h2>HW10</h2>
<div id="exercises-2" class="section level3">
<h3>Exercises 2</h3>
<p><strong>Problem.</strong> The function below scales a vector so it
falls in the range <span class="math inline">\([0,1]\)</span>. How would
you apply it to every column of a data frame? How would you apply it to
every numeric column in a data frame?</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Solution.</strong> First, we generate a data frame.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>), <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  2 variables:
##  $ x1: num  1.5 2.5 3.5 4.5
##  $ x2: num  14.99 2.95 2.61 4.23</code></pre>
<p>The first problem can be solved directly with
<code>lapply()</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(x, scale01))</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>res1</span></code></pre></div>
<pre><code>##             x1            x2
## 1 0.0000000000 1.00000000000
## 2 0.3333333333 0.02774753513
## 3 0.6666666667 0.00000000000
## 4 1.0000000000 0.13086373975</code></pre>
<p>If we want to apply it only to every numeric column in a data frame,
we can augment a condition in function while conducting
<code>lapply()</code>.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a non-numeric column</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>x3 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">2</span>))</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(x, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>res2</span></code></pre></div>
<pre><code>##             x1            x2 x3
## 1 0.0000000000 1.00000000000  A
## 2 0.3333333333 0.02774753513  A
## 3 0.6666666667 0.00000000000  B
## 4 1.0000000000 0.13086373975  B</code></pre>
</div>
<div id="exercises-1" class="section level3">
<h3>Exercises 1</h3>
<p><strong>Problem.</strong> Use <code>vapply()</code> to:</p>
<ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data
frame.</li>
<li>Compute the standard deviation of every column in a mixed data
frame. (Hint: you’ll nees to use <code>vapply()</code> twice.)</li>
</ol>
<p><strong>Solution.</strong> This problem is approximately the same to
the previous. First, we generate a numeric data frame.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">1.3</span>, <span class="fl">7.6</span>, <span class="fl">2.4</span>), <span class="at">x2 =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  2 variables:
##  $ x1: num  0.6 1.3 7.6 2.4
##  $ x2: num  -2 2.22 1.65 2.66</code></pre>
<p>The first problem can be solved directly with
<code>vapply()</code>.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>res1 <span class="ot">&lt;-</span> <span class="fu">vapply</span>(x, sd, <span class="dv">1</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>res1</span></code></pre></div>
<pre><code>##          x1          x2 
## 3.171093397 2.127010571</code></pre>
<p>While in a mixed data frame, we should add a condition.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a non-numeric column</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">$</span>x3 <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>, <span class="dv">2</span>))</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">vapply</span>(x[<span class="fu">vapply</span>(x, is.numeric, <span class="cn">TRUE</span>)], sd, <span class="dv">1</span>)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>res2</span></code></pre></div>
<pre><code>##          x1          x2 
## 3.171093397 2.127010571</code></pre>
</div>
<div id="c-version-gibbs-sampler" class="section level3">
<h3>C++ Version Gibbs Sampler</h3>
<p><strong>Problem.</strong> Implement a Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span>
with zero means, unit standard deviations, and correlation 0.9.</p>
<ul>
<li>Write an Rcpp function.</li>
<li>Compare the corresponding generated random numbers with pure R
language using the function <code>qqplot()</code>.</li>
<li>Compare the computation time of the two functions with the function
<code>microbenchmark()</code>.</li>
</ul>
<p><strong>Solution.</strong> To generate a bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span> from <span class="math inline">\(N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho)\)</span>,
we notice that <span class="math display">\[\begin{align*}
X\mid Y=y&amp;\sim
N\left(\mu_1+\rho\dfrac{\sigma_1}{\sigma_2}(y-\mu_2),(1-\rho^2)\sigma_1^2\right),\\
Y\mid X=x&amp;\sim
N\left(\mu_2+\rho\dfrac{\sigma_2}{\sigma_1}(x-\mu_1),(1-\rho^2)\sigma_2^2\right).
\end{align*}\]</span></p>
<p>So we implement the Gibbs sampler below.</p>
<ul>
<li>Set initial value <span class="math inline">\(X_1\)</span>, <span class="math inline">\(Y_1\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(X_t\sim f_{X|Y}(x\mid
Y_{t-1})\)</span>.</li>
<li>Generate <span class="math inline">\(Y_t\sim f_{Y|X}(y\mid
X_t)\)</span>.</li>
<li>Increment <span class="math inline">\(t\)</span>, and back to the
first step in the loop.</li>
</ul></li>
</ul>
<p>The function below generates <span class="math inline">\((X_t,Y_t)\)</span> with pure R language.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear memory and set seed</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22004</span>)</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, rho, initial, N) {</span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mu, sigma, rho: parameter of bivariate normal distribution.</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initial: initial value</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N: length of chain</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> Y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma</span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>  X[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">1</span>]; Y[<span class="dv">1</span>] <span class="ot">&lt;-</span> initial[<span class="dv">2</span>]</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> Y[i<span class="dv">-1</span>]</span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho <span class="sc">*</span> (y <span class="sc">-</span> mu[<span class="dv">2</span>]) <span class="sc">*</span> sigma[<span class="dv">1</span>] <span class="sc">/</span> sigma[<span class="dv">2</span>]</span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>    X[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s[<span class="dv">1</span>])</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> X[i]</span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho <span class="sc">*</span> (x <span class="sc">-</span> mu[<span class="dv">1</span>]) <span class="sc">*</span> sigma[<span class="dv">2</span>] <span class="sc">/</span> sigma[<span class="dv">1</span>]</span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a>    Y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s[<span class="dv">2</span>])</span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y))</span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The function below is a Rcpp function (but saved in file
<code>gibbsC.cpp</code> actually).</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="pp"># include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>using namespace Rcpp<span class="op">;</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>NumericMatrix gibbsC<span class="op">(</span>NumericVector mu<span class="op">,</span> NumericVector sigma<span class="op">,</span> <span class="dt">double</span> rho<span class="op">,</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>                     NumericVector initial<span class="op">,</span> <span class="dt">int</span> N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// mu, sigma, rho: parameter of bivariate normal distribution.</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">// initial: initial value</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">// N: length of chain</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>  NumericMatrix XY<span class="op">(</span>N<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> x<span class="op">,</span> y<span class="op">;</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>  XY<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> initial<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>  XY<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">=</span> initial<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span><span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> mat<span class="op">(</span>i <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>    m1 <span class="op">=</span> mu<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">+</span> rho <span class="op">*</span> <span class="op">(</span>y <span class="op">-</span> mu<span class="op">(</span><span class="dv">1</span><span class="op">))</span> <span class="op">*</span> sigma<span class="op">(</span><span class="dv">0</span><span class="op">)</span> <span class="op">/</span> sigma<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>    mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> rnorm<span class="op">(</span><span class="dv">1</span><span class="op">,</span> m1<span class="op">,</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">-</span> rho<span class="op">^</span><span class="dv">2</span><span class="op">)</span> <span class="op">*</span> sigma<span class="op">(</span><span class="dv">0</span><span class="op">));</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>    m2 <span class="op">=</span> mu<span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">+</span> rho <span class="op">*</span> <span class="op">(</span>x <span class="op">-</span> mu<span class="op">(</span><span class="dv">0</span><span class="op">))</span> <span class="op">*</span> sigma<span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">/</span> sigma<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>    mat<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">=</span> rnorm<span class="op">(</span><span class="dv">1</span><span class="op">,</span> m2<span class="op">,</span> sqrt<span class="op">(</span><span class="dv">1</span> <span class="op">-</span> rho<span class="op">^</span><span class="dv">2</span><span class="op">)</span> <span class="op">*</span> sigma<span class="op">(</span><span class="dv">1</span><span class="op">));</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span><span class="op">(</span>mat<span class="op">);</span></span>
<span id="cb136-24"><a href="#cb136-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Next, we generate the bivariate normal chain and compare them.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co"># generate chains</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>XYR <span class="ot">&lt;-</span> <span class="fu">gibbsR</span>(mu, sigma, rho, mu, N)</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>XR <span class="ot">&lt;-</span> XYR<span class="sc">$</span>X[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]; YR <span class="ot">&lt;-</span> XYR<span class="sc">$</span>Y[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;C:/Users/10313/Desktop/StatisticalComputing/HW/HW11/gibbsC.cpp&#39;</span>)</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>XYC <span class="ot">&lt;-</span> <span class="fu">gibbsC</span>(mu, sigma, rho, mu, N)</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>XC <span class="ot">&lt;-</span> XYC[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b), <span class="dv">1</span>]; YC <span class="ot">&lt;-</span> XYC[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b), <span class="dv">2</span>]</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(XR, XC, <span class="at">plot.it =</span> <span class="cn">TRUE</span>)</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(YR, YC, <span class="at">plot.it =</span> <span class="cn">TRUE</span>)</span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>With the qqplot, the results of two methods are approximately the
same. Besides, we can draw the scatter plot of each.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(XR, YR, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(XC, YC, <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next, we compare the computation time of the two functions.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import package</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR =</span> <span class="fu">gibbsR</span>(mu, sigma, rho, mu, N),</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">gibbsC =</span> <span class="fu">gibbsC</span>(mu, sigma, rho, mu, N))</span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr       lq   median      uq
## 1 gibbsR 27.55185 28.47005 29.6651
## 2 gibbsC  1.60135  1.64800  1.7145</code></pre>
<p>As we can see, the Rcpp function runs faster than pure R
language.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
